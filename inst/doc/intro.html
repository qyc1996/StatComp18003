<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="18003" />

<meta name="date" content="2019-01-18" />

<title>Introduction to StatComp</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to StatComp</h1>
<h4 class="author"><em>18003</em></h4>
<h4 class="date"><em>2019-01-18</em></h4>



<div id="exercise-1" class="section level1">
<h1>Exercise 1</h1>
</div>
<div id="example-1" class="section level1">
<h1>example 1</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>pi,<span class="dt">length=</span><span class="dv">100</span>)
y1&lt;-<span class="kw">sin</span>(x)
y2&lt;-<span class="kw">cos</span>(x)
<span class="kw">plot</span>(x,y1,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>)
<span class="kw">lines</span>(x,y2,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>,<span class="dt">lwd=</span><span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> #example 2</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1958</span>);
y&lt;-<span class="kw">rnorm</span>(<span class="dv">100</span>)
<span class="kw">hist</span>(y,<span class="dt">freq=</span><span class="ot">FALSE</span>)
res&lt;-<span class="kw">density</span>(y);
<span class="kw">lines</span>(res,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAArlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q27aQ2/+2ZgC2Zjq2ZpC2kGa229u22/+2///bkDrbkGbbtmbbtpDb27bb29vb////AAD/tmb/25D/27b//7b//9v///8APG5dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKsElEQVR4nO2deWOjNh6GSTvTZJttdyeZ6RH32COe3WZppw1OYr7/F1uEwICN9Ar00+H0ff6YCcZI8FgI3RQ1sVKkPoHcoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggDBBe03xdtH/f/lYWO0+z//k47w41VR/F0suMSCnj98Ji1oVzTciAUXV9AJ20JcUFlc3AsGlyQF/XpdFBd/e1B+GpSiT98Uxefftolr/7Eo3ty35ppr/ceH4rOH+tOH5ntfNdf9cltcfrouLr6vf71qvjVEcwigDbJV1P8kTZK6W3/+KQSVRdGJ6QV1n6gvNl9RV3g9fPz2cad3N5fdCNJc92o1QwCDoObD9gt+qTSGoJ5OkEoFj/VvbUahT/7pqvN20/7el4/7be/t7UP9R3PUF4/qSzetoBt1bPF99/2WcQDDLdZ8eqcTncf5JxDUnPebX7q9WtB29FPrv5ur0oL6m+P3/16rAJrPGxP639bYOJi6vy/vD1Ff+t5hKQTpT3SO015SfxeqS+v/nlzr/sc+AJ0c9L+DoHEA40y61MaPShbLSJEHPX/QWcq/Og/9TaB+6/7vsSBl9M3Pv98aBY0DGAtS91izz+uZn6Yc9PzTdZ+lOqQgbeLFLMiUglScvk/9ZAXF/Q9DjmPOg9qL07lIn0nPCDLkQa2xa787LIWg5nrftfdZ++BRV2N+ivUp6O3j88acBxmeYu3nvqXqFCno46FY09YLbOWgQx5kzaTH5aCJIHWkZ1E9yS32m8qBvnqou2LzQ1cQ/k4f0Hz09cPJU+zNP9UzySRoFMAk01Hp0e/8c23u8Hw493gWguoMBW3btoomdXj+8i1NRudbGc5OUFfvkqiStxU334aP7ATVz99cdXV9XxpBF+98A8lPUGZQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCLBG0NOV57C2dRRTYsW64LuHqTaF99jRNRSWrVixAnZ6QFuqFGTZihUr4uVWjT2lIAvbi3sKslIWN9EE2bLlbAU16efzaIKct2KdgxP7je/odVfOVFA8zlhQGaUcdMaCjkMJU759PYICBUdBi0KrNEFicj0HRD/3z5gDhRN0UNP9n6Wgsp9ctDPNMgomqNFSjP7OU9B+M8wRNcwHDCVoqkQZylHQy+2hgLgz3GRhBOm7ypCeAnMOKWgm16mqHAU1eVCXhOLmQdVM2IenWWiWtgcN89MFgkPo0OYf7LEM5V8OqiZbwz4K0qFVJkF1HEP5CzKETUE6tGqyZdwXjnMWFMVQ5oKqydZxTFEFeS4WdxycCEhQDEOjWMvsVrqYPsrn2oPCG5rG6u1IVtD08nMQpBV5tDfHFhTe0CRWtTTNXVMnXb+2kaigalbJdCuiIFXP0mZMbRmLghPARVBwQ6OnmMQqw5KCjtt8Ugt6r/2sSj5Bun3cBIU2dCLIr0tQUNBJs2pSQdshDWTymD9tdzZthTV0koKEgvPmtOfCKCiooWzrYu6CwiahXAUd92Ocbg1UIce86pBfbm8OQ1jzyKSxoMmXQwvKLri57mWLoICdQHkKmu1/t2xFEdTcZu1rCHJYnnquJyy5oK16X8FlvfVqNpM50WqpoIAPslFd7K6pzd/51FRrMUGzoWUgaKsWuU4vyNgTZtkKZmh0i12qiQYvt8lvMXNXoWUrgiC1uPD9fmP1UxbdCt+mdCYiyBCafSuUoUVXVLavH1IKAwqy9oSZt3IQpMcHtS2y4QRVKwWFMjTEAwdoHkaYNQWCYIImVfO8BG3h4+swwmx7GUrQtOlikaBAhkaPedxS1mvRL5axBucc/4Sqcp4AlUCQwxSefgzefiMmaLxx3PSVlSDwgF8a3JoDTirlywSFMTTEs5OYBeYhqDod25uVoGUNZmKZ9NA5MTN8fqGgIIZkapfr+8X6A07Gip9unrOg9cF1B8zPUFkqKIShUTztuye3kV9XpjMPwxynvATtLu5LVZu3GZKfDjXNXb0FyRsaPeZv2hkYtvagANOhislV+QoKkIQmBUUlyNKiGGIyS2Gpvq8QJG/oJAVtza32IaZD2cZp5iWoy4NKS3ExSAqy1E4zE6SLitZRVAGmQ9mGIa4RJG5o2RWJT4eqpAQF66lPW1A8rp4KpKDTgVd+HNXFfN/duVSQ9aqzErTteiuivvgXDCJbJ0h4rEcX1q7PnD0XT1p0amiMVEaCRq1lEfvmAwmSHcqgwxrVwOJ1PcMxUlkJgmXkJcE5MdcCJCNItCyUTJDDGKk/qaBReQ4tbbdWkORQhgSC2n9dhgB5CJIz1AsaiupRBBnaEKUECd5k8asaWtD8AXKCxAylEeQ2BMhDkFwSkhG0pNunsDSyCgqSMpQiBbkOAfIRJJaEkggyHiAoSMpQAkHOY6Q8BckYii/IfYyUnyAhQ9EFWRtZRQXJ3GTxBblfp7cgCUOxBTlOZcY7XbYkDEUW5DxTF+502hIwFFeQ+1RmuNO6NekD8usFiipo0TzLRV81bnmvahpTEG5DlBfkvappREGLZ8mJCPKd0LrsYJ8BVMtnyckI8sypFwnyGEC1ZhKYkCA1wNg4fB+y5Osew18cGzjCCCqG5cwtp2hgyddXD6BaOYVHTlBdr14MP0YKWjuFR1JQfXAUUNC6AVTrZ6gIC+oUhRTkOoBqPL/paILTkjlO4oLqepIbORGkHNQHOpuo0wqqVYPdEkfBBBnfEZJc0OTcICsF2Wf7VNMzyE7QEmRS0DjPmct2siKFoFcMBQGEK6uvD+HK6utDuKrRBZoZ6/WIV1YdArXtjH8gJEwKWhvjmQtyqKw6BPqaBeHKqkOgr1qQRKAUREF+gVIQBfkFSkGvCwoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAQIIqi0rGTV9j2aW7SfvpzvLtlZF8cyHQWjw4QQpIZ+7AyXs980O0rjS4Ffbuf7k1RwpiDNR8HoHAggqF0pxbT6sl5+xzR6Zmfo1dYdTqaFaUxHwehcCJUH2ZenNiSGXXEz3yNpvU7jUSg6J0IJKq3nZF4/3yDoL/fGfeajHKLDhBG0s2eMln7H+UvVScCcEOyCvIZahLvFzJ2LO0umGUCQLTpMsHKQ5WpsP6j8LeY5VEdW0Oh17KerxXU7ZxfaOxy4IpM2HtWFHHmFbIy+GtM52xaLNR5mf8zbBIHoMCFuMbWg8GiozISnK/sParhUe0HRLAhFhwmSB6kXIxt+uFIPD1mc3dpqLxZBKDoMK6sACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBA7oLaQVOl15s7/chdkBr5s994jhLzIXdBatUrPYQzEbkLUveYfbmrwGQvqLnHtimX3Mte0Mv7f79PeIflL2i/+WvKOyx/Qd4jwT3JX1DSZ9hZCPo65R12BoLKtMvG5i7o6SppFp2/oORQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMD/AU3B9+xlN7p2AAAAAElFTkSuQmCC" /><!-- --> #example 3</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lattice)</code></pre></div>
<pre><code>## Warning: package 'lattice' was built under R version 3.4.4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(quakes); 
mini &lt;-<span class="st"> </span><span class="kw">min</span>(quakes<span class="op">$</span>depth) ;
maxi &lt;-<span class="st"> </span><span class="kw">max</span>(quakes<span class="op">$</span>depth) ;
int &lt;-<span class="st"> </span><span class="kw">ceiling</span>((maxi <span class="op">-</span><span class="st"> </span>mini)<span class="op">/</span><span class="dv">9</span>);
inf &lt;-<span class="st"> </span><span class="kw">seq</span>(mini, maxi, int) ;
quakes<span class="op">$</span>depth.cat &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">floor</span>(((quakes<span class="op">$</span>depth <span class="op">-</span><span class="st"> </span>mini) <span class="op">/</span><span class="st"> </span>int)), <span class="dt">labels=</span><span class="kw">paste</span>(inf, inf <span class="op">+</span><span class="st"> </span>int, <span class="dt">sep=</span><span class="st">&quot;-&quot;</span>)) ;
<span class="kw">xyplot</span>(lat <span class="op">~</span><span class="st"> </span>long <span class="op">|</span><span class="st"> </span>depth.cat, <span class="dt">data =</span> quakes)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> #example 4</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;pressure&quot;</span>);
<span class="kw">names</span>(pressure)</code></pre></div>
<pre><code>## [1] &quot;temperature&quot; &quot;pressure&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm.summary&lt;-<span class="kw">lm</span>(temperature<span class="op">~</span>pressure,<span class="dt">data=</span>pressure)
<span class="kw">plot</span>(<span class="dt">x=</span>pressure<span class="op">$</span>pressure,<span class="dt">y=</span>pressure<span class="op">$</span>temperature,<span class="dt">xlab=</span><span class="st">&quot;pressure&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;temperature&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(lm.summary)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAyVBMVEUAAAAAAA0AADoAAGYAOpAAZrYXKJAoAAAxUSo6AAA6ADo6AGY6Ojo6gZA6kJw6kNtmAABmADpmAGZmOpBmZmZmkJBmnJBmnZBmtrZmtv98ezqQAACQOgCQZgCQkGaQtpCQtv+Q2/+2AAC2ZgC2tma225C2/7a2//++vr7bAADbkDrbtmbb25Db/7bb////AAD/ADr/AGb/OgD/Ojr/Omb/OpD/ZgD/Zrb/kDr/kNv/tmb/tpD/trb/tv//25D/2////7b//9v////FKq5KAAAACXBIWXMAAA7DAAAOwwHHb6hkAAARbElEQVR4nO2dC5vrNhGGzV5a9hRICgVO6NKypLSH0K5bLqUYmmb9/38U1oxGlmxZI8mS7c3R9zy7iWNFtt9Io7umaoucqta+ga2rAGJUADEqgBgVQIwKIEYFEKMCiFEBxKgAYlQAMSqAGBVAjAogRgUQowKIUQHEqABiVAAxKoAYFUCMCiBGBRCjAohRAcSoAGJUADEqgBgVQIwKIEYFEKMCiFEBxKgAYlQAMSqAGBVAjAogRgUQowKIUQHEqABiVAAxKoAYFUCMCiBGBRCjAohRAcSoAGJUADEqgBj1gC77XXuqqrvnFe9mg+oBHe+ezw/37fF+xbvZoBSgy/7QNlX3d/vVmvezORmAjh2cUwFkSMti95f93fNlX7KYId1IVzdPL4+Fj6ksxfzLYwXaWc6JrIxqbp4cZyd1XLaczQQI0qGw+Q4VQEx+fU2AOvujlKAUIzLwLCeZ184P3ZuDRNB9ePPZzRMcwL8jnIT3MiB8Rbx0IPuPdEAYswpEV7p8/Jl4iCN95YjX6u8kSNlT0Km7tfODfI4u0yGO7gGaSgN0lCG79xRQxXO8+7r/SAMkY6ZAz3QlURi3KkZ1LXUnYcoJ6AQJRtxRV/ukCiimEfGsxx7Q5eMnTC/de72mKiplXQxG5ZUAqZhlIHUMb1SM2rXk+bBnMYr5dFkMozqQoenu8rLHiKHGDm8bPYuJFIIZkAKqwCKYdlMESIsZAhnHrYpRXUudD3sWoy12ug+PwCZIQaJhBzcpWQE1tEGnEaDOPNz+BVMQBcSbugcgxkcESMWMgdSxsnIQo7pWHz5IWlNj1zbdtU8JCgnMYo2wiGZRJXPVKAXBzyKzGAWE1+b2S0oP9JGZgvpA6hjiUDEOUlCwjLbY+aOv4G+upA06otXVTkAOIrtwknahO4KnaKoeUP/6CeUuxU7ZoIOK9RMwQwctoIpRu1ZU3lCAXh53YNkSAoLiBEsS+QNSohEfNtCyuXvuss8BE0+1AyMtA2JUx+peHjWDFKRiloHUsUpBEKNZiql0GA4IMutxlzCLCTuww9oH/pxVpZKUrAdByfAWbdDNE2VADIjCwl3/6KiaMRQz1QDkcX+FJ4mvuv1ChFPhQ6QV852t6+73Ons74nu5rr5PGmwQ1oGidPWAsDoQX3fRSrF0bbFr0jAFlS7pgUZZrIxqmBoBKknI1AjQvFGNak3VdUDgWEAzRzVyFIp17R/UO2Q4ICrF5lWk89QaAhD5Bo5OQTOF0b1LGykogJEPooUBDbJ2DkDdY4elI3foQEDJOu2zV8xDEpLrZEQKgv4t61hMgPK3XEKSkSMdhQNSXRSzrHTGLEYKymmTwWNKMWzQOSuK1Bs/GcYGKKDS4aswe2SDFJOCsEfANXB5onG3ZmoAznLdKuR2/BWRjvSvRNkg2Xk7GZYYttMZcXzdqg2quAapDk5JKjjd0Pk75jvanUNR5rJAWrf3VEYcZzHRBGgzARIKS0nqC/KGmjoAECvvFGQCEreUkVAbarchHeH9fP/tf1MCgrFkUIANAkC58pjSyMZwisliHmIbbDZAmfOYpoCUFAgIxv7T1aSNYl4koXx2eiDvlJQpBXled1gP6gCJ0iztpRzySEm5AU11q1mjAzO9KCE+JUUAmrMUwd1RtwIglKOeFAEoyVIEa1usQ1OvAghlpRTXFpu/FMHeWAUzveYY5TjDycKprv+Fxz90GK2JKfFShAkIwkyvPoZb64YJ7ubl7z+2P/wbjr//ceJbiZci2ClUcF+rE0LVfU368h0ZoZd//DQRPGQpgke/41QW2xAgFNzMuctfl28FmovAZk1EQXf98sjlv9cFqFGAzt1/eyoKu2t2rcuUDRLtsaAr5dYgBYGsdsjs7rh7Pron0jDLLyYpdFbaOFzdZA9sEIgB1Nw8nYSRjp5q1Ec37pM2AWXqZAyRLMX+I0sxkdle/jkZEAI/4vzEFMX8CJCZxSrzyqtIrweJRNTVg761FmRGPUgASlFRtHyqG+kt2Oy4TnsBaN5qI29Adf3aAEkbdJoxna+dymLDJANNs8DxrcSKGZuHeuC8gVU/G9RC0yx4CDCpYgDNuRw3L2lQzBOZ9RDFDxzmua4JSMOyFqL4oecU1+WymAFlHUQxRjrF7E0/Iz1AsgaimBSUb37QANCYx/KIFjbSTHQsoOURrQuIsUF2FssS2hggoxSbIrFoItpWFmvNkn3y2wsi2h6gymmC1LmlEG0vi6lLMQgWQhQIKPE0YKuRppMsgEUQxVQUM04DDgK0CKKYtli6acCWjxUgv2cHRDl7ruPbYlEtDpU/33W56133D19tf7XjnBGu9gsX+Rffmk/Ro2iZSK5KMe/cgz1qudJQlA3ipgHPuW49ePWKKmPPdXSPonsaMJhxfqa9RZSCwmYR5uu5zlIPAkBgxCc7j9h6UED5BKNnuQq0bIAkGv950vJjaU+CHrfK2HMdmcXcQ88CkNyAyT3T3vJxDCBSDkTRwz6uoWfvFGT5eA6gHIjiBw4dQ8/YILlvyVxPRjdpg+KfMzWiuIoiP/QMs6ymVyJw9aA5T5kW0baGntsUgNIiWnfo2fJ5TYZoltIhyj307J5pP1XMJ3i8VIg21mGWDlAqRBvrcq0sU7njlQJRTCmG/UHzujucNiidjZ2PKGpkFbfcS74sHE/UCWy0prmIYgC93cN+jg5AvsvCbRsL1KlHBudFF1VR7NLHzgUoalk4nagT5jDUrEQU2eV6qu7+5mpqeC4Lt32ePAW1sxDF9kmfHxzDPlHLwunjOstc+2hE0Z32xt7WQ/kuC18OUDSiTPWgiGXh9HEuQJGI5IBpwIK6NHLZoHyDXBGI4Gb8F9QFrZt3Tfd01oMyKhgR3E3YgjpvRQHKrsD9O+BGky+oQ/GAbCfyL4DyQlTLpeJwN/4L6oJmd8QAqhzn0smJyFxEP0hBIG69mO/sjogsVg2ulU1WRLZtGAY2COQGNGt2x6A1vx4gCyJ7spKlWMCCulmzO8bR2T5eBFBPpHbt4KXXg/wW1KWc3WH/fCE+LfQccAZ73dkdtnrQkst4PfZ+o7tJusmbh9arB4H6XMUhks+ddpM3D61YDxoicSPCuwnZ5C3zejHHuSSy4XAgqsOzWOb1Ysa1kspVVtmrRfq9BNigjOvFcgIKm5euaMakoHzrxTIB8tuoVAUyAseUYim0pA3ybr4LREOY6wLKXg8K3r59FDwCUBInkLPqQTAsaa+I0YwtbEsPHrcZuJ9rjOIG4QwRRdSkkziBnFMPwu4Euws5AlRXn1q+aH5FwTJb8bXVBrHSjHQKJ5AzbJD8aYRXv/FJCai2Ohi0AxpnK30BSNywT7QTyBTdHfTL/A+d8kmvw/JNB6iuT9Xu8pvnVvdrbPhExhPw/7n3jfx2j6GFAz/RM44OjcMBpXECOQBEbSN8rQbHhozdv9Bh5n3/5rJ/oFG5s+HXWPOJ3DtL3reab2Tp/hEPqvqv3Wv1sIuwQUmcQHL1IPHz2o2cPnEWmz2N2JRPvKnB3ygx0Su0hk9kOlF37zXfyDvpvheirwTptmpuYwYOPZxAek5/sX/e/UESfWPtUNEB4XN3/8Wbuobn+wUN5upjv4ZH2+7En0W6VF1/6Bj49x991f2TQ+oV2Kuq+50cT+n1RFbNmP6C5qkBx97WJKRnMQSEHnzxibuc8jmB1fwamz6RXz6tlMP23jdyJdxjf/i7N3+ArMHN9Jp4Ij/FT17QBanfIoqyQb+0AtO+pqQk0pfe1ykrAyoF1cLuyBPKHol/x+qXIgV98PXDW7huE1eK+Q37zJj+0teDJrtVtGJe2qDqSRkjbZmIfivkp/hT3Y+xskdNn8U++Gb/KwBEAaO6XLlhnxkTqFQ9yLEWBG7g5RGmuY1LsR0WWQO/xl3ZVNeyFOudJe9azTcyAPrwcPoZbsQqHRrHFPP8sM+c6S+tLMUcFXWtz7ce14NammdquDrW60F04liJCfHkG5mM9M8rXGeCDo3jKopweVcx5jn9ZRKQZ0MmqdM+qthdfq0/WFxFUSjLsA8Bgtosu9jBD4+v3xoBSBQMJ2Mb2nWHfeyfV3iVRG5KvRMZpKBmmOpjivmQYZ/AtRqqFDvefO5uyiy1u0meiqJvdK56kLut54Un0CeUVesCcskJyI+P9904FAGIbWe5YvGvwc/rLUimmB5FDzInKoOCbZDSJCCPfBPqcM2huB5FTtinArWt1IB8njyl/Y6vKDqEVSXoEw3y7WPIDmihsqtXfFPDIWIouvejAcUqMcLoiqJLqrF6vI/PYnFKXj2KyWL80DNhme54xCjeVUHi3cSHOJL3VHKSSEimMsYDiSvSDOdio/RSFqNxnYC8h575qVbXCch76Pk9BeQ/9PzeAvIden5PAfkPPb+ngNIMPQ8jXeTcUsW8x9BzeKRLnHt99aBrUm+k5YhwktnAV6QRoHn+xa5PEtCxb8WlWJFwRRqloCJTxUgzIkDnhx2MP870L3Z9koDUzMiZ86SvT2SkYW6cKMDmuVO/PiEgGPPBbvtSDzJFgA4tbTheABnSAMkJfwkaq9ckzQbB1CCP4bH3SxIQzH0UacdnhH5KRi0hoMqgB4UpFH6V+eEV5s2NmxLVg3AK1vlhxkXELFM1SdY48P8eTHI9VT6peHiFZu6af7vS1aSxo1HWEoyDgO9JO+iRjIdXgB35g2+aVzpAxrP5P6gtqE/SG37tdPfHrQOCtRSylmAcBHwP5WMIB1/rDvPaoPnCn13++MZBwPfwEx8rbX5NZLj3BlDjbaO1JQmzd+Of0vaymFf6sV1u84DSGOmTZy3I+NpJ9oZm6InYWDHfentlGF9h6ykoSUUR+u0iLie0eUCwNEk15+RB4PdkXvH6pnG59jUAukoVQIwKIEYFEKMCiFEBxKgAYlQAMSqAGBVAjAogRgUQowKIUQHEqABiVAAxKoAYFUCMCiBGBRCjAohRAcSoAGJUADEqgBgVQIwKIEZbAJRnUD2RCiBGBRCjbQFCjwU4eayBKeW4F/DHn4n1/EeaQ9a9EVsAU/is2hQgsVrk/LDDGT9iNxo8buUqCVpPQq4QKHzWm9sSILUeS8w8BPfT8hh3kyZHB5orhAXWb20JEE6ogx3sYX9x4xhDiDymNrJX53Pe3KYAqbmqXW7qPlTHCIgcHShXCE2+ua29NgVITU1sbr+kTeqF+vV+4t8gBWXWlgD1m4Fe9p+AGepdHbS9owNyhfDksXnofG0JEHksgH3777VjlYLA0YFZik3420qmTQBSm4acaBc+uS2oPFY2CBwdwBduvxDhVPh82gKgKC21OvsVAgIb5LO7cxK9QkBYHVhqB43XCGhRFUCMCiBGBRCjNIDGddqXx8PAIWyI4r8ZJJ9tyXIBOt3PcNC+SBtCqOH7MjMBQqeMmwck0jmjZIDOD8Lj6076Ce3queKd2H4ZGxHG6fObzx9kX6mtUxW++Q1uaXSQZ6Y6V1VUg3DkrVa+XiZi4zcDSggI+pDF1cWT3st0QL2ixunurg/Y3LJ3qqr0Bx4LxZnJzlUVlRmO9mTrndPaY+N7TBIC2sk1ueT2FR9T9ooap/Hmul9volPVBEQe/Kj5JXbQETvV/AkB6VGpcNRSo9ep2PjuyISAtE4tup++F9U4rYYtJjpVTUAHrTMWghygPY+ZQ0VlhiNvtf2rPTa+SZcHkLz4oe9FNU+/kdtKTHSqjgFNdq6qqAbhyFutfJ2KbS1AgxTUah2mJiB7p+pECrJpAMjckkoeUZebJbb1ACkbJH/0QQKDXROE4bB2qirrpbO2y4zKDEdHZHsssa1lg2Qptut7TQeAxK4JVIqNO1XFN9Fjr8p8U52rKiozHDmlpdep2BYtxUYjD0eqB3UHA0C/Jbfq9k5V8U3hCOXtnsz3VOeqimoQjpzS0utEbEvVg0Zy14UTjvXNi8qjyp6rNX9ybfyyGUCLtcXGcrZytgJoudb8FasAYvR/ZnxyzQNxJCQAAAAASUVORK5CYII=" /><!-- --> #example 5</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cells&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">16</span>,<span class="dv">24</span>,<span class="dv">68</span>)
rnames&lt;-<span class="kw">c</span>(<span class="st">&quot;R1&quot;</span>,<span class="st">&quot;R2&quot;</span>)
cnames&lt;-<span class="kw">c</span>(<span class="st">&quot;C1&quot;</span>,<span class="st">&quot;C2&quot;</span>)
mymatrix&lt;-<span class="kw">matrix</span>(cells,<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>,<span class="dt">dimnames =</span> <span class="kw">list</span>(rnames,cnames))
mymatrix</code></pre></div>
<pre><code>##    C1 C2
## R1  1 16
## R2 24 68</code></pre>
</div>
<div id="section" class="section level1">
<h1>3.5</h1>
<p>Idea:<br />
1.Generate U~U(0,1)<br />
2.If <span class="math inline">\(F_X\)</span>(<span class="math inline">\(x_{i-1}\)</span>)<span class="math inline">\(&lt;\)</span>U<span class="math inline">\(\le\)</span><span class="math inline">\(F_X\)</span>(<span class="math inline">\(x_{i}\)</span>),Then X=<span class="math inline">\(x_i\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2</span>)
x&lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>);
p&lt;-<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>);
cp&lt;-<span class="kw">cumsum</span>(p);
m&lt;-<span class="dv">10</span><span class="op">^</span><span class="dv">3</span>;
r&lt;-<span class="kw">numeric</span>(m);
r&lt;-x[<span class="kw">findInterval</span>(<span class="kw">runif</span>(m),cp,<span class="dt">left.open =</span> <span class="ot">TRUE</span>)<span class="op">+</span><span class="dv">1</span>]<span class="co">#&quot;left.open=TRUE,because in findInterval function ,the intervals are open at right and closed at left.</span>
r</code></pre></div>
<pre><code>##    [1] 1 4 3 1 4 4 1 4 2 3 3 1 4 1 2 4 4 1 2 0 3 2 4 1 2 2 1 2 4 1 0 1 4 4
##   [35] 3 3 4 1 3 1 4 1 1 1 4 4 4 2 3 4 0 0 3 4 1 4 4 4 3 4 4 4 3 1 4 2 2 2
##   [69] 1 0 1 2 0 1 1 4 1 4 2 3 2 3 0 2 1 4 4 2 4 2 4 2 2 3 2 1 2 0 1 2 1 2
##  [103] 4 4 1 3 4 2 1 1 0 4 2 3 4 4 4 1 4 3 0 1 4 4 1 4 3 2 3 2 1 4 0 4 2 3
##  [137] 3 4 1 2 1 1 3 2 2 4 3 2 2 1 1 2 4 2 4 1 4 1 0 1 4 4 0 4 1 3 0 4 0 3
##  [171] 4 1 1 4 2 4 2 1 3 3 4 3 4 4 1 4 0 4 0 0 1 2 4 1 3 1 1 1 1 1 4 3 3 4
##  [205] 2 4 1 1 1 1 4 3 4 3 4 0 2 0 2 1 1 4 2 2 3 4 4 2 4 4 3 2 4 3 4 1 3 1
##  [239] 1 2 4 2 3 4 4 4 2 3 1 2 4 0 1 0 4 0 0 1 0 3 4 0 3 2 4 3 0 3 4 3 4 4
##  [273] 4 1 4 2 4 1 0 1 1 4 3 3 1 4 3 3 4 2 1 2 4 2 4 2 1 0 1 3 4 2 2 4 4 0
##  [307] 1 3 4 0 0 2 4 1 3 0 3 2 4 1 3 1 1 0 2 1 3 1 0 0 1 4 4 2 0 0 1 3 4 4
##  [341] 4 4 4 0 3 2 3 4 1 2 1 3 2 4 1 4 4 3 0 3 1 1 1 0 3 1 1 0 4 0 4 0 3 3
##  [375] 3 3 1 4 3 0 1 2 2 1 0 3 2 3 4 4 4 4 2 1 1 1 1 4 1 4 3 3 1 0 4 4 3 2
##  [409] 1 4 3 4 2 0 2 3 4 2 3 4 4 0 1 3 4 1 0 3 3 0 3 4 4 2 0 4 1 4 4 2 3 1
##  [443] 4 3 1 3 4 3 3 1 3 4 2 1 4 4 2 4 4 3 4 0 0 2 1 4 2 4 0 2 1 2 1 0 3 4
##  [477] 3 0 1 4 2 4 4 4 4 2 4 2 4 4 1 3 3 4 3 1 2 4 2 3 3 3 2 1 2 4 2 2 4 3
##  [511] 3 0 2 2 2 3 4 3 2 4 4 0 2 4 2 0 0 3 1 4 0 4 4 1 3 4 4 1 2 4 0 4 2 4
##  [545] 3 0 1 4 3 4 4 2 2 3 4 3 2 3 3 4 4 0 4 2 4 2 1 3 4 1 4 3 4 4 3 4 4 0
##  [579] 2 1 1 1 4 3 3 4 2 0 4 4 2 2 3 0 0 4 0 1 1 0 2 0 2 1 4 1 0 1 4 3 4 2
##  [613] 3 1 4 1 4 3 1 4 3 3 2 2 2 0 0 4 1 1 3 2 4 3 3 3 3 1 2 2 2 4 4 1 4 3
##  [647] 3 4 3 1 4 2 4 2 4 2 4 3 2 1 4 3 2 4 2 0 4 0 4 0 2 2 4 0 2 4 4 4 3 1
##  [681] 3 1 3 2 0 1 3 3 4 3 2 0 2 0 4 1 4 3 3 3 4 4 4 3 2 0 4 2 4 0 4 1 1 1
##  [715] 4 1 4 3 3 1 4 4 4 2 2 4 2 4 0 2 1 3 2 4 4 2 2 3 3 1 2 2 4 3 1 2 4 3
##  [749] 2 1 1 2 2 4 4 2 3 0 4 4 2 2 1 4 3 3 1 2 4 3 0 1 3 2 2 1 4 4 4 2 3 2
##  [783] 4 3 4 0 4 0 2 1 3 4 1 1 4 1 3 4 4 4 2 3 0 1 1 4 1 3 4 1 2 2 1 4 0 2
##  [817] 4 3 3 4 3 0 1 0 3 0 1 0 2 4 0 0 4 3 1 3 4 4 3 3 4 3 1 1 4 4 4 0 4 2
##  [851] 4 1 4 1 4 1 1 4 3 2 1 2 2 4 1 4 4 4 3 2 2 1 2 4 3 3 2 3 2 3 0 0 2 1
##  [885] 0 1 3 3 3 4 2 4 1 1 4 0 0 1 3 2 1 2 3 1 2 4 1 4 4 2 2 1 2 1 4 3 4 0
##  [919] 3 3 2 4 3 3 2 1 1 1 4 3 3 4 3 4 2 3 4 4 0 3 4 1 4 0 4 4 0 0 3 2 1 3
##  [953] 2 4 1 4 0 2 2 0 1 4 3 3 1 4 2 4 4 2 1 3 0 4 3 3 1 4 1 3 4 1 3 2 4 2
##  [987] 1 4 3 2 2 4 1 2 1 1 2 4 3 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ct&lt;-<span class="kw">as.vector</span>(<span class="kw">table</span>(r));<span class="co">#calulate frequency of the table &quot;r&quot;</span>
ct<span class="op">/</span><span class="kw">sum</span>(ct);</code></pre></div>
<pre><code>## [1] 0.111 0.203 0.189 0.195 0.302</code></pre>
</div>
<div id="section-1" class="section level1">
<h1>3.7</h1>
<p>Idea:<br />
1.<span class="math display">\[Generate\quad random\quad numbers\quad U\sim U(0,1)\quad and\quad Y\sim g(.)\]</span><br />
2.<span class="math display">\[If\quad U\le\rho (Y)\quad then\quad accept\quad Y\quad and\quad stop(return X=Y) \quad\rho(x)=\frac{f(x)}{cg(x)}\]</span><br />
3.<span class="math display">\[beta(\alpha,\beta) \quad with\quad pdf\quad f(x)=\frac{x^{\alpha-1}(1-x)^{\beta-1}}{B(\alpha,\beta)}.
\\g(x)=1,0&lt;x&lt;1 \quad and\quad c=\frac{1}{B(\alpha,\beta)} \]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rnbeta&lt;-<span class="cf">function</span>(a,b,N){
  n&lt;-N;
  j&lt;-k&lt;-<span class="dv">0</span>;
  y&lt;-<span class="kw">numeric</span>(n);
  <span class="cf">while</span>(k<span class="op">&lt;</span>n){
    u&lt;-<span class="kw">runif</span>(<span class="dv">1</span>);
    j&lt;-j<span class="op">+</span><span class="dv">1</span>;
    x&lt;-<span class="kw">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g</span>
    <span class="cf">if</span>(x<span class="op">^</span>(a<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span>(b<span class="op">-</span><span class="dv">1</span>)<span class="op">&gt;</span>u){
      <span class="co">#we aceept x</span>
 k&lt;-k<span class="op">+</span><span class="dv">1</span>;
 y[k]&lt;-x;}
    
  }
<span class="kw">return</span>(y)};
x&lt;-<span class="kw">rnbeta</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1000</span>);
p1 =<span class="st"> </span><span class="kw">hist</span>(x,<span class="dt">plot =</span> T,<span class="dt">freq =</span> <span class="ot">FALSE</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>),<span class="dt">col=</span><span class="st">&quot;yellow&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;a-r menthod for generating random number&quot;</span>);
d=<span class="kw">seq</span>(<span class="dt">from=</span><span class="kw">min</span>(x),<span class="dt">to=</span><span class="kw">max</span>(x),<span class="dt">by=</span><span class="fl">0.01</span>) 
<span class="kw">lines</span>(<span class="dt">x=</span>d,<span class="dt">y=</span><span class="kw">dbeta</span>(d,<span class="dv">3</span>,<span class="dv">2</span>),<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)<span class="co">#add density curve</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> #3.12<br />
Question:Simulate a continuous Exponential-Gamma mixtrue</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n&lt;-<span class="dv">1000</span>;
r&lt;-<span class="dv">4</span>;
beta&lt;-<span class="dv">3</span>;
lambda&lt;-<span class="kw">rgamma</span>(n,r,beta);
x&lt;-<span class="kw">rexp</span>(n,lambda);
<span class="kw">hist</span>(x,<span class="dt">plot=</span>T,<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">breaks=</span><span class="dv">50</span>,<span class="dt">col=</span><span class="st">&quot;skyblue&quot;</span>,<span class="dt">main=</span><span class="st">&quot;Exponential-Gamma mixture&quot;</span>)
<span class="kw">lines</span>(<span class="kw">density</span>(x,<span class="dt">bw=</span><span class="dv">1</span>),<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">lty=</span><span class="dv">2</span>)</code></pre></div>
<div id="section-2" class="section level2">
<h2><img src="data:image/png;base64,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" /><!-- --></h2>
<p>title: Homework-18003-2018/9/28 author: A18003 date: 2018/9/28 output: html_document  #5.4 Write a function to compute a Monte Carlo estimate of the Beta(3, 3) cdf,and use the function to estimate F(x) for x = 0.1, 0.2, . . ., 0.9. Compare the<br />
estimates with the values returned by the pbeta function in R<br />
<span class="math display">\[\Phi(x)=\int^{x}_{0}30t^2(1-t)^2dt\\let\,\,y=\frac{t}{x},we\,have\,dt=xdy\,\,\,then\\\theta=\int^{1}_{0}30x^3y^2(1-xy)^2dy\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x&lt;-<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="dt">length =</span> <span class="dv">9</span>)
m&lt;-<span class="dv">10000</span>
<span class="kw">set.seed</span>(<span class="dv">111</span>)
u&lt;-<span class="kw">runif</span>(m)
cdf &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {
g&lt;-<span class="dv">30</span><span class="op">*</span>(x[i])<span class="op">^</span><span class="dv">3</span> <span class="op">*</span>u<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[i]<span class="op">*</span>u)<span class="op">^</span><span class="dv">2</span>
cdf[i]&lt;-<span class="kw">mean</span>(g) 
}
Phi &lt;-<span class="st"> </span><span class="kw">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)
<span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">rbind</span>(x, cdf, Phi), <span class="dv">3</span>))</code></pre></div>
<pre><code>##      [,1]  [,2]  [,3]  [,4] [,5]  [,6]  [,7]  [,8]  [,9]
## x   0.100 0.200 0.300 0.400  0.5 0.600 0.700 0.800 0.900
## cdf 0.009 0.058 0.163 0.318  0.5 0.683 0.837 0.941 0.989
## Phi 0.009 0.058 0.163 0.317  0.5 0.683 0.837 0.942 0.991</code></pre>
</div>
</div>
<div id="section-3" class="section level1">
<h1>5.9</h1>
<p>The Rayleigh density is <span class="math display">\[f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)}\,, x \,\, 0, \sigma &gt; 0.\\ \Phi(x)=\int_{0}^{x}\frac{t}{\sigma^2}e^{-t^2/(2\sigma^2)}dt\\let\,\,y=\frac{t}{x}??we\,have\,dt=xdy\,\,\,then\\\theta=\int_{0}^{1}\frac{xy}{\sigma^2}e^{-(xy)^2/(2\sigma^2)}xdy\]</span> Implement a function to generate samples from a Rayleigh(??) distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X'}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1, X_2\)</span>?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MC.Phi&lt;-<span class="cf">function</span>(x,sigma,<span class="dt">R=</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {
u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)
<span class="cf">if</span> (<span class="op">!</span>antithetic)
v&lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)
<span class="cf">else</span> 
v&lt;-<span class="dv">1</span><span class="op">-</span>u
w&lt;-<span class="kw">c</span>(u, v)
cdf &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {
g &lt;-x[i]<span class="op">*</span>w<span class="op">/</span>(sigma)<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>((<span class="op">-</span>(x[i]<span class="op">*</span>w)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">*</span>sigma)))<span class="op">*</span>x[i]
cdf[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(g)
}
<span class="kw">return</span>(cdf)
}
x &lt;-<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">1</span>,<span class="fl">2.5</span>,<span class="dt">length=</span><span class="dv">5</span>);
pRayleigh&lt;-<span class="cf">function</span>(x,sigma){
  s&lt;-sigma;
  p&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(x));
  intergrand&lt;-<span class="cf">function</span>(x){
    x<span class="op">/</span>(s<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>((<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(s<span class="op">^</span><span class="dv">2</span>))))};
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)){
  p[i]&lt;-<span class="kw">integrate</span>(intergrand,<span class="dv">0</span>,x[i])<span class="op">$</span>value;
  }
  <span class="kw">return</span>(p)
}
Phi&lt;-<span class="kw">pRayleigh</span>(x,<span class="dt">sigma=</span><span class="dv">2</span>)
<span class="kw">set.seed</span>(<span class="dv">123</span>)
MC1&lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x,<span class="dt">sigma=</span><span class="dv">2</span>,<span class="dt">anti=</span><span class="ot">FALSE</span>) <span class="co">#for (X1+X2)/2 which X1,X2 is independent</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
MC2&lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x,<span class="dt">sigma=</span><span class="dv">2</span>,<span class="dt">anti=</span><span class="ot">TRUE</span>)  <span class="co">#for antithetic variables (X+X')/2</span>
<span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">rbind</span>(x, MC1, MC2, Phi),<span class="dv">5</span>))</code></pre></div>
<pre><code>##        [,1]    [,2]    [,3]    [,4]    [,5]
## x   0.10000 0.70000 1.30000 1.90000 2.50000
## MC1 0.00124 0.05914 0.18972 0.36228 0.54172
## MC2 0.00125 0.05941 0.19046 0.36329 0.54246
## Phi 0.00125 0.05941 0.19043 0.36317 0.54217</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">1000</span>
MC1 &lt;-<span class="st"> </span>MC2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
x &lt;-<span class="st"> </span><span class="fl">1.95</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {
MC1[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x,<span class="dv">2</span>,<span class="dt">R =</span> <span class="dv">1000</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)
MC2[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x,<span class="dv">2</span>,<span class="dt">R =</span> <span class="dv">1000</span>,<span class="dt">anti=</span><span class="ot">TRUE</span>)
}
<span class="kw">print</span>(<span class="kw">sd</span>(MC1))</code></pre></div>
<pre><code>## [1] 0.005707144</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">sd</span>(MC2))</code></pre></div>
<pre><code>## [1] 0.001627423</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>((<span class="kw">var</span>(MC1) <span class="op">-</span><span class="st"> </span><span class="kw">var</span>(MC2))<span class="op">/</span><span class="kw">var</span>(MC1))</code></pre></div>
<pre><code>## [1] 0.9186865</code></pre>
<p><font color="#FF0000" size="3">The antithetic variable approach achieved approximately 91.9% reduction in variance at x = 1.95.and <span class="math inline">\(\sigma=2\)</span></font></p>
</div>
<div id="section-4" class="section level1">
<h1>5.13</h1>
<p>Find two importance functions f1 and f2 that are supported on <span class="math inline">\((1,\infty )\)</span> and are ??close?? to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\quad    x &gt; 1.\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling? Explain.<br />
<font color="#FF0000" size="4">Solve:</font><br />
let <span class="math inline">\(f_1(x)=\frac{1}{\sqrt{2\pi}}e^{-x^2/2}\quad -\infty&lt;x&lt;+\infty\)</span><br />
<span class="math inline">\(\quad f_2(x)=e^{-x+1}\quad 1&lt;x&lt;+\infty\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dt">length=</span><span class="dv">100</span>)
y&lt;-<span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>);
z&lt;-<span class="kw">exp</span>(<span class="op">-</span>x<span class="op">+</span><span class="dv">1</span>)
<span class="kw">plot</span>(x,y,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))
<span class="kw">lines</span>(x,z,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y1&lt;-x<span class="op">^</span><span class="dv">2</span>;
z1&lt;-y1<span class="op">*</span>y<span class="op">/</span>z;
<span class="kw">plot</span>(x,y1,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))
<span class="kw">lines</span>(x,z1,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAADoAAGYAOjoAOpAAZrYA/wA6AAA6ADo6AGY6kNtmAABmADpmZmZmtv+QOgCQZgCQ2/+2ZgC2/7a2///bkDrb/9vb////AAD/tmb/25D//7b//9v///+77GBcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHXklEQVR4nO2di5qbNhBGnXS328Rt3DqhFWvr/V+zFuJqM/q5aEDAf/Il8besuRyPRhIM+GRJkNPaO5A6FASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIEFnQaTOsJSju6hQwxrj/KEjAlH8pqB8fP2ZxQeOb9jo4PWYNQVqri4wx3hAFCZgihgxzkEARQOzFZEz5x0FBr5TxQ0ECZfbxfijoBdMJIAp6xuuxlR8KeqLwY+v4oaAnjCkN1T+hoA5l+BgK6se0h4geJUH3i5+Sfv0VZXVLUQVQ60c6grLTd/8ir17MWt1SdDt4j4qg+6XWkr39N3t1S2GqSXwbFUG384/qZS40sgQFvSZoByOo4mUE5NHKQWUIbScHCX60erHb2fdiQvykJ+h1hFjCcZDH2J784+BJ+wLfffX40RJ0PZ3ei8HiD+EX0hLU28F7lJL0I/dcT+8uF20hSfd38B69bj7/8o/dRjffMwNr0Bso+iHiBgaKVf7p9cMIKgdAVvCjnYNaY+oZq9Mk2L4se7FggnYcfaAozTBqDi4INbCjC0Ltyx5cEGxf9tiChvg5siDTqeKQOK4gnJ8LDisoPMFoOKogMMFoOKigge3LHlVQXQNEQb3UNUDYzyEF1e1rgJ9DnrQf3r7sISOoLKIf5ueAgox8iaePwwka1b7s4QTVF5iH+hkrqLrmHqwei7rdqIzp30vGRtD9MsvL+O3GpE4/w/2Mb2L3y/vI3Zq33YiMb192Sg7KxSsVY1hB0IT2ZY+UpE1fDSvmMIKm5B/HUQSZcePnhvGCHj19hDS9sKD6/NhYP5MiKHsMgoRL7hWJVdrX+Wf8Wyc2MeAosUr7qfnHMTkHZYH4SKxOelr/XjJNUF7UbdwvwtEnVWlfDQ+n+ZkiyM3HvBnp6FOKoFnhY6f1YkXpWJB0Ku1N7y08I9h5pX19dWeqn50PFCcPDxt2fdJ++vCwQVXQ54c48V9AUNN9zVmLUp00PO+oL6gJn/QEVZ3XihFkTJwA0uvFXP+1nqBmcDjTj14Ouj5GS6sJihU+VjNJPyasKwmqL31F8KPZi31+/LaKoKY2Yb4e3W7+fpHP7+sJMnNnX112N5KOl308exMUN3zs7gTNO/fTx54EtbJPND87ElT167G6r5LdCKqjJ2L+cexEkGkTdc37EKQVPnYnglrJJ7afPQhqT71i69m+IKW+q2Hjgho3Sn62fdJer+9q2HIEKfZdDZsVZMwS8bNdQS01mno2KqjTden62aSgxo9y9Dg2J6h9TkNfz+YEdRLPEn42JaibeBaJny0J6qblZezYzQhqzbdin1MFbEGQeSXuzoRIXlBHy+J6EhfUUbOGHZuuoHbIWKN5RgyQoqCenLOSHZuYoBcfa9uxaoIm3e3TFH2//jtq6zHRETTpbp+Wn/VbVo2KoGn3aggBtKoetTJg6W6f0Dnph5Dfk0JP0MS7fbptbMT2NNHKQZPu9kki6TyhViedxt0+81ltHLQZVhI0bKVg+bzFc98+79fjrJSC5i2nIAqat5yCKGjecgqioHnL9y9oT1AQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBAfEH56RR64GBRIBJ+ZOxVvOzmHq1yCj6U1z1JVHyyyOe3XwP2sEt0Qe6bfHN5+/fLY1kWPMZcvi5p88ei21l+d+a2Lhm6nf3XMIf38InYgvz1+6t4CP7ZQ1ngKwZuZ1mQX7v8bv9kfmHrua9rQnv4RGxBWIAj9AFmb3+Lgj7/CH/wIUH56XtRkzJsD2uiCyoOQXoabMVVXv5YgZyD8q8/z+EHOoeamN+tYXtYE1uQjw3QxMXiEN8AZEGZayTBb7gIJuDCyqA9bFhDUB7I0cUXksuCvoBP34Xm54ekPwVBAwI4ED/+7QFBxXrlh8yB/JJCE8MpMAs/FN4jGPCHJadqEB0pJGnYiWb4G2DkCPJVkvKn7w9eXJ4n0M2jYZicIBoCI2mXolqlkq9vxTlo5YFi0UpCoxzfhIL7F5pq5GCicg0tL0MrvIdPcLIKoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCpC7IVYLdzrimSI3UBblqKemJcouQuiBXGv3n4GonBZIXZK/BGzvUSV+QXDi/CMkLul/+Glqxq0LygrK3fwNVrfqkLshVRg+uitcgdUHXojB6xTSduqDVoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAP8DxVcVu1tUE20AAAAASUVORK5CYII=" /><!-- --></p>
<p>we can see both f1 and f2 are close to g</p>
</div>
<div id="section-5" class="section level1">
<h1>5.14</h1>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">10000</span>
<span class="kw">set.seed</span>(<span class="dv">111</span>)
theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)
g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
<span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">*</span>(x <span class="op">&gt;</span><span class="dv">1</span>)
}
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(m) <span class="co">#using f1</span>
fg &lt;-<span class="st"> </span><span class="kw">g</span>(x)<span class="op">/</span><span class="kw">dnorm</span>(x)
theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)
se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)
<span class="kw">set.seed</span>(<span class="dv">222</span>)
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#f2, inverse transform method</span>
x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u)
fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x<span class="op">+</span><span class="dv">1</span>))
theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)
se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)
<span class="kw">print</span>(<span class="kw">rbind</span>(theta.hat, se))</code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.3923036 0.4011763
## se        1.1297321 0.1561412</code></pre>
<div id="we-can-see-f2-has-smaller-variance" class="section level2">
<h2><font color="#FF0000" size="3">we can see f2 has smaller variance</font></h2>
<p>title: Homework-18003-2018/10/12 author: A18003 date: 2018/10/12 output: html_document  #6.9 Let X be a non-negative random variable with<span class="math inline">\(\mu =E[X] &lt; \infty\)</span>. For a random sample<span class="math inline">\(x_1,...,x_n\)</span>from the distribution of X, the Gini ratio is defined by <span class="math display">\[G=\frac{1}{2n^2\mu}\sum^{n}_{j=1}\sum^{n}_{i=1}|x_i-x_j|\]</span> The Gini ratio is applied in economics to measure inequality in income distribution.Note that G can be written in terms of the order statistics<span class="math inline">\(x_{(i)}\)</span>as <span class="math display">\[G=\frac{1}{n^2\mu}\sum^{n}_{i=1}(2i-n-1)x_{(i)}.\]</span> f the mean is unknown, let <span class="math inline">\(\hat G\)</span> be the statistic G with <span class="math inline">\(\mu\)</span> replaced by<span class="math inline">\(\bar x\)</span>. Estimate by simulation the mean, median and deciles of <span class="math inline">\(\hat G\)</span> if X is standard lognormal. Repeat the procedure for the uniform distribution and Bernoulli(0.1). Also construct density histograms of the replicates in each case.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n=<span class="dv">50</span>
m=<span class="dv">1000</span>
G_sam1&lt;-<span class="kw">numeric</span>(m)
G_sam2&lt;-<span class="kw">numeric</span>(m)
G_sam3&lt;-<span class="kw">numeric</span>(m)
<span class="kw">set.seed</span>(<span class="dv">110</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)
{
  x&lt;-<span class="kw">sort</span>(<span class="kw">rlnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>))
  y&lt;-<span class="kw">sort</span>(<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">1</span>))
  z&lt;-<span class="kw">sort</span>(<span class="kw">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.5</span>))
  J=<span class="dv">2</span><span class="op">*</span><span class="kw">seq</span>(<span class="dv">1</span><span class="op">:</span>n)<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>
  G_sam1[i]=(J<span class="op">%*%</span>x)<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">mean</span>(x))
  G_sam2[i]=(J<span class="op">%*%</span>y)<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">mean</span>(y))
  G_sam3[i]=(J<span class="op">%*%</span>z)<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">mean</span>(z))
}
log_norm&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(G_sam1),<span class="kw">median</span>(G_sam1),<span class="kw">quantile</span>(G_sam1,<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)))
unif_norm&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(G_sam2),<span class="kw">median</span>(G_sam1),<span class="kw">quantile</span>(G_sam2,<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)))
Bern_norm&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(G_sam2),<span class="kw">median</span>(G_sam1),<span class="kw">quantile</span>(G_sam3,<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)))
A=<span class="kw">rbind</span>(log_norm,unif_norm,Bern_norm)
<span class="kw">colnames</span>(A)=<span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;median&quot;</span>,<span class="kw">names</span>(<span class="kw">quantile</span>(G_sam1,<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))))
<span class="kw">print</span>(A)</code></pre></div>
<pre><code>##                mean    median        0%       10%       20%       30%
## log_norm  0.5022976 0.5016018 0.3411792 0.4348382 0.4565540 0.4729876
## unif_norm 0.3302178 0.5016018 0.2345940 0.2861274 0.3005249 0.3130809
## Bern_norm 0.3302178 0.5016018 0.2800000 0.4200000 0.4400000 0.4600000
##                 40%       50%       60%       70%       80%       90%
## log_norm  0.4891027 0.5016018 0.5143755 0.5298606 0.5446379 0.5719688
## unif_norm 0.3217759 0.3307332 0.3379000 0.3472442 0.3579776 0.3736499
## Bern_norm 0.4800000 0.5000000 0.5200000 0.5400000 0.5600000 0.5800000
##                100%
## log_norm  0.7162766
## unif_norm 0.4475830
## Bern_norm 0.7200000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(G_sam1,<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">col=</span><span class="st">&quot;skyblue&quot;</span>,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&quot;G density histograms for lognorm&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAvVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtrZmtttmtv+HzuuQOgCQZgCQZjqQkDqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa225C229u22/+2///bkDrbkGbbtmbbtpDb27bb29vb2//b////tmb/25D/27b//7b//9v////D/QUzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKqElEQVR4nO2d6WLbNhaFaceu1bpLKjVd7PF0r5jO4rBJZkRZ0vs/VrERBLgdCSRlmDznh6LQ914AHwEQoEAwOVCdSp47A7GLgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIBcQB++TZLk1ev/V23S5PIdjrR/SK434p8/G2yz5GLtm7mOTR59tH+7SJLXrX+tZaBTJSDhqHVxX7E5BdDTmybbLkDNHn2Uy1Is2/4aCsjySWo4jgPUZesAOtKjj7pSCwcksF/cCcf3C4e+rKxXv+ki7N8Ki9cbnYE/xH+uVC7+uhWHv3o0CaeqCt4mNybkvc1y4WHyZ93S4pTIBv7qu41OVtqqZIXnr2+Sy8fDhzfC7gsRYLdKbj7ciswe/lpU86Ck87B2I9ooDqDW9MqyKZuSq8G+/fxuUx60dUrkS+rqnUzOtMW1/S4MSkCXP+lKUdaNLPHNHLcCkDmiurEHg9kevt7kNkmTkSS5LdCWwTxATsTMfrOAOtPTZdP/MSzkealVL5Grm43EqwoiTsB2IWuX8Lt6lJ9L5bY5vJdfdcIKijC790IK22vjocwcN4NRuGhuyyLZtOAmPP8nvD7Z6OQloKX0Te5qebD1de1HNFGKs3696UqvKJu2KQDpolek8y4ycPlOfCxV2jrIvfK4kR9X/z04Caemlty4Lcx4qBjKzHEziaROpXOSNZ5KH/8t6syNPC7S0Z8q124wB5Ab0Yni5rM1PVU2fbwCKHfqoimnNhR/t3VPZ0BVEF07VVN2E850urYz9D2uN46bRXptOot18b3oE1TL3/+ok78xFVN/qly7wcrU3Ihet11koCu9MqeHShPzABVtRHrmSSMgcZHWR3/3AMk2ZupcIyDHTXsUScla5yZbFE1CuPrl46oJkBusTM2NWAcE0tuVCVU66WoNsmh1t1IrrtDTz7fKxQUk656bqRqg0u24GqRJ7JoBOcHGq0H2Mr//+Mam5PdBthP3Ack0/yksvLadyYvC9abBwxmGKDfYB6mi5UXXsGwEZIM5qfl9UAUQSE9H9/ogd6Boh+lu957KkcfTSvf9Noiw+Fo1mOKklGfcHcxWATluDdcc/6pSxLvePD009kFuMCc1/ypWBdSdno1eXsXcqcadPZaW4xcz/NBjnzLIW9sz6YRzO9pxB8i1GlS6FR6t4xLbB7V10m4wJzV/HFQF1J2eaR3uOEjq47cL72ogXP+1SF7d6Sr49KP4qxquekHey9b/RTGS1oPSR31Wyjj1JmbdrIca2X6vkxWHvnysXcWufstsY/eaWBnMBeREbADUmV7RfTgj6aHlDIJC5QwTzqLm9EYCJHqE8CloqnpBPVg7hzrTGwWQ6q9a7zdAFWOurjn5kOpMbyxAF1/38H+SnWE5PR9dXenxlisQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQ0DCAyuWNg4SLSQOXiIDOGC6pacDgx+ci3nDJPyoioEosAgKxCAjEIiAQi4BALALyXWsiIN+1xoOAfNcpAEr1I83tDwnMHJDi86l6XKjlUZ55A9qt5GPu6pGYrOVJpbkDuj/sH9RTPLn/sNMQ88kJAFK1J2MNatduJR9ulo/BtvXSMwdknz1rfRRw9oBGDEdAyJWAgCsBAVcCAq4EBFwJCLgSEHAlIOAaOaDGbfDCwwW4Rg5I75YTvuFGLdzJrtEDOoQzmtHtjiyp7+XaI9wpri8AkJyry3ti4RsbTRmQ3PRHk8nDq9CEAe1WQ+xnNGVA32g+ParPYRaAMgLys6X/ScsLda+h0GQBlTVooHABrpEDevZwBIRcYwa0Wy3tVvHspP1sBfhsF627kM4bkK1k7fVsyoDk2o0s6dxgNtdjgJnWoFS+rODGLG9p0W4l+dUBzeF2h1zbkou5PJhqpGLGNs8aJAHJFWRoqpEly3kCEm1LNqDdCt2Z3i5ezROQ3ON4vX/Ad+73D+2bjU8Z0HOHIyDkGjug4s0MnGr42bLf0iFeFDdhQGoR9HDhAlyjB9T3PRheuADXyAEdc4E/IVyAa+SA1DxjwHCnu0YOiDfMWrIVTbhJA5rD7Y6DfvFk2u9if3QZ6k+oRg8ov1hncjZ/nh8Oa6Vv4BEXIPkUj3zI6Uw/Pb88QHKgKAGdafFCEKDn2A+mVoPSXq+FGxdQ3adHVo/NqP2m+6Cs33BxyoD0ULHnKqpJAzprOAJChi8OkJ6L9X1x53QBpbpzznqutZ8sIPucd8ePgge9zFyD7Lt44YUBcu6Wdf02n6n3uKu3IM8MkDMD65hq6G0p1EL8+QGyDatjqlFYicF21nfvjkkCMhubyGbIGtSoAosYEhBQo4qZ2v5hdoDg6sNTwh1j+LIAnT8cASFDAgKGBAQMCQgYEhAwJCBgSEDAkICAIQEBw3kBmvztjvOHIyBkSEDAkICAIQEBw2EAjb8e5oUDqh0YtjinlGjgcASEDAkIGBKQfxwu+p07oJDCvkBA8KnEmQOyq4fytmVE8wZkf5s//b0a8wDU/gN1ZSTbsOI7Io0H6IgaND2d2AeZKtTaB01Pp1W4YpHDbOrP4OOg6WkUQM/bCVfUtyyDEDk9aEwmo/qHBo3JZFT/0KAxmYzqHxo0JpNR/UODxmQyqn9o0JhMRvUPDRqTyaj+oUFjMhnVPzRoTCaj+k9eBAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBAQwLK3Q2sstDdrNwo+ofKkF14nSi5+f0nbO+xAQHJHWTsLjJyD4I8hJAXZftp4I5hXhQp/LaHFg0HSC9tMJvHqN1SQnZg9qIE71noR5EK3h5yOEB65yE3IyGA/ChZ4Gmv5WW7CF1tMSAg1Rzcc54FNDE/Svp5EvTSxVpewjfsHw6QbvJlw8+DiuZF0e9aCth/t5qXHjvUjgfoEPRO5HqUkI6odrLCt4ccs4mF5KshSve2akdF6bH/6piddFDRGqKcfq2vROmzB/RIl3mdw4DGMUKUoBNlNdZAUVZqZ9FnaBRZxJBN0v2BYo8uaNCphpld6OFPGjq4HyFKn03EOVkFIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgKKBpBa8XviMp7tZ31e1HScYgGkNrdqfStXs3arXm+yOk6RADIreE5aF5v3fNXXcYoEULFGLnPXumwXZvGLWQSzXfwg2uFSHr5X+6j1e/X7cYoDUONSK1WrcsFCLqOSS4q3C/GRyWpjFvzMB5CzQ2Opovi7b9aalloNbj7uXYsxFRMg2ZKcIrt9cC5blcJSfswLULFJrFtktbXuvVpOd/mfxawB2U66VuT0Ym2RzBlQsVC3VmTR+NSxfN5NrNiJOXUfnlOLd3Ndg8Q4ezlvQHqq4RdYPiooIaklvW5bmyWgWEVAQNEBUvOLJAl9JHhwRQcoNhEQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEB/Q1xe/TP3WOdcgAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(G_sam2,<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">col=</span><span class="st">&quot;skyblue&quot;</span>,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&quot;G density histograms for  uniform&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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1kUG8zx9bHLEXQ2sSRsDrRFPNbKTAz17yQJchumo/h6b9QZevq4Ge9sHtTDY82QVioCACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAhoNoBkdW6bfYncyuJxNRdAsj5m99B8BWq+snhczQRQtjTKuxllsxz9bv7eRDMBZBfHJf66lOd1tlAlW7DyvP6raocb/bZNFiz/GUXzAOTtr5dLYiRVLPSSp0RuXyqtSgWNC5z4TCLI26Exl10m9/rNo6El69SyB5N+gt345gRItyQvIl5v8xepblWCJX8IVhaPprkAspvE+k1GBvJ7WUl3+du6DGiS3RznAch10qXVp/HFo0NSAHT4xt1DaSaAXKdSBKQan7yXlppY0mIlZg/NBFAWDrHfqcgQnpoIUvPsTQgoX1k8ruYCyJxqhPGTZiuHZTWv39b0g7eyeFTNBtBcRUBAswMk5xeTNJ5mmh2guYmAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgI6P8y/qj24yubQQAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(G_sam3,<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">col=</span><span class="st">&quot;skyblue&quot;</span>,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&quot;G density histograms for  Bernoulli&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> # 6.10 Construct an approximate 95% confidence interval for the Gini ratio <span class="math inline">\(\gamma = E[G]\)</span> if X is lognormal with unknown parameters. Assess the coverage rate of the estimation procedure with a Monte Carlo experiment.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n=<span class="dv">20</span>
m=<span class="dv">100</span>
G_sam1&lt;-<span class="kw">numeric</span>(m)
alpha=<span class="fl">0.025</span>
UCL_low&lt;-<span class="kw">numeric</span>(<span class="dv">1000</span>)
UCL_upp&lt;-<span class="kw">numeric</span>(<span class="dv">1000</span>)
Mean&lt;-<span class="kw">numeric</span>(<span class="dv">1000</span>)
<span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)
{ <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) <span class="co">#generate m replitcates</span>
 {
  x&lt;-<span class="kw">sort</span>(<span class="kw">rlnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>))
  J=<span class="dv">2</span><span class="op">*</span><span class="kw">seq</span>(<span class="dv">1</span><span class="op">:</span>n)<span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>
  G_sam1[i]=(J<span class="op">%*%</span>x)<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">mean</span>(x))
 }

UCL_low[k]&lt;-<span class="st">  </span><span class="kw">mean</span>(G_sam1)<span class="op">-</span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha)<span class="op">*</span><span class="kw">sd</span>(G_sam1)<span class="op">/</span><span class="kw">sqrt</span>(m)
UCL_upp[k]&lt;-<span class="st">  </span><span class="kw">mean</span>(G_sam1)<span class="op">+</span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha)<span class="op">*</span><span class="kw">sd</span>(G_sam1)<span class="op">/</span><span class="kw">sqrt</span>(m)
Mean[k]&lt;-<span class="kw">mean</span>(G_sam1)
}
fin_mean&lt;-<span class="kw">mean</span>(Mean)
k=<span class="kw">sum</span>(UCL_low<span class="op">&lt;</span>fin_mean <span class="op">&amp;</span>UCL_upp<span class="op">&gt;</span>fin_mean)
k<span class="op">/</span><span class="dv">1000</span></code></pre></div>
<pre><code>## [1] 0.948</code></pre>
</div>
</div>
<div id="b" class="section level1">
<h1>6B</h1>
<p>Tests for association based on Pearson product moment correlation <span class="math inline">\(\rho\)</span>, Spearman??s rank correlation coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall??s coefficient <span class="math inline">\(\tau\)</span>, are implemented in cor.test. Show (empirically) that the nonparametric tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span>, are less powerful than the correlation test when the sampled distribution is bivariate normal. Find an example of an alternative (a bivariate distribution (X, Y ) such that X and Y are dependent) such that at least one of the nonparametric tests have better empirical power than the correlation test against this alternative.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
mu0&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)
n&lt;-<span class="dv">20</span>
m &lt;-<span class="st"> </span><span class="dv">1000</span>
ptest&lt;-stest&lt;-ktest&lt;-<span class="kw">numeric</span>(m)
pho&lt;-<span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="dt">length=</span><span class="dv">21</span>)
<span class="co">#alternatives</span>
power1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">21</span>)
power2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">21</span>)
power3 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">21</span>)
<span class="kw">set.seed</span>(<span class="dv">122</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">21</span>) {
sigma_i &lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span><span class="op">+</span><span class="fl">0.04</span><span class="op">*</span>(i<span class="op">-</span><span class="dv">1</span>),<span class="fl">0.1</span><span class="op">+</span><span class="fl">0.04</span><span class="op">*</span>(i<span class="op">-</span><span class="dv">1</span>),<span class="dv">1</span>),<span class="dt">nrow =</span> <span class="dv">2</span>)
<span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="st"> </span>m){
x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n,mu0,sigma_i)
ptest[k]&lt;-<span class="st"> </span><span class="kw">cor.test</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>],<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)<span class="op">$</span>p.value
stest[k]&lt;-<span class="kw">cor.test</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>],<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="op">$</span>p.value
ktest[k]&lt;-<span class="kw">cor.test</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>],<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">method =</span> <span class="st">&quot;kendall&quot;</span>)<span class="op">$</span>p.value
}
power1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(ptest<span class="op">&lt;=</span><span class="fl">0.05</span>)
power2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(stest<span class="op">&lt;=</span><span class="fl">0.05</span>)
power3[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(ktest<span class="op">&lt;=</span><span class="fl">0.05</span>)
} 
<span class="kw">plot</span>(pho, power1,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)
<span class="kw">lines</span>(pho,power2,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
<span class="kw">lines</span>(pho,power3,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;yellow&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> for X Y is independent</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
m=<span class="dv">1000</span>
n=<span class="dv">20</span>
mean&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)
sigma=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)
p_pearson&lt;-<span class="kw">numeric</span>(m)
p_Spearman&lt;-<span class="kw">numeric</span>(m)
p_Kendall&lt;-<span class="kw">numeric</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)
{
  sample=<span class="kw">mvrnorm</span>(n,mean,sigma)
  x=sample[,<span class="dv">1</span>]
  y=sample[,<span class="dv">2</span>]
  test1&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>)
  test2&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method=</span><span class="st">&quot;kendall&quot;</span>)
  test3&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>)
  p_pearson[i]&lt;-test1<span class="op">$</span>p.value
  p_Spearman[i]&lt;-test2<span class="op">$</span>p.value
  p_Kendall[i]&lt;-test3<span class="op">$</span>p.value
}

ratio=<span class="kw">c</span>(<span class="kw">mean</span>(p_pearson<span class="op">&lt;</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p_Spearman<span class="op">&lt;</span><span class="fl">0.05</span>),<span class="kw">mean</span>(p_Kendall<span class="op">&lt;</span><span class="fl">0.05</span>))
<span class="kw">names</span>(ratio)&lt;-<span class="kw">c</span>(<span class="st">&quot;peason&quot;</span>,<span class="st">&quot;Speqrman&quot;</span>,<span class="st">&quot;Kendall&quot;</span>)
<span class="kw">print</span>(ratio)</code></pre></div>
<pre><code>##   peason Speqrman  Kendall 
##    0.047    0.048    0.048</code></pre>
<div id="as-shown-from-the-resultat-least-one-of-the-nonparaments-test-have-better-empirical-power-than-correlation-test." class="section level2">
<h2>As shown from the result,at least one of the nonparaments test have better empirical power than correlation test.</h2>
<p>title: Homework-2018.11.02 author: A18003 date: 2018/11/02 output: html_document  #7.1 Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap);</code></pre></div>
<pre><code>## Warning: package 'bootstrap' was built under R version 3.4.4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(law);<span class="co">#attach data</span>
n =<span class="st"> </span><span class="kw">length</span>( LSAT )
R.hat =<span class="st"> </span><span class="kw">cor</span>( LSAT,GPA )
R.jack =<span class="st"> </span><span class="kw">numeric</span> ( n )
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)
  { R.jack[i] =<span class="st"> </span><span class="kw">cor</span>( LSAT[<span class="op">-</span>i],GPA[<span class="op">-</span>i] ) } <span class="co">#jackknife</span>
bias.jack =<span class="st"> </span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>( <span class="kw">mean</span>(R.jack) <span class="op">-</span><span class="st"> </span>R.hat )
R.bar =<span class="st"> </span><span class="kw">mean</span>(R.jack)
se.jack =<span class="st"> </span><span class="kw">sqrt</span>( (n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>( (R.jack<span class="op">-</span>R.bar)<span class="op">^</span><span class="dv">2</span> ) )</code></pre></div>
<p>we find <strong>-0.0064736</strong> for the bias and <strong>0.1425186</strong> for std.error</p>
</div>
</div>
<div id="section-6" class="section level1">
<h1>7.5</h1>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures$ $by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(boot); </code></pre></div>
<pre><code>## Loading required package: boot</code></pre>
<pre><code>## Warning: package 'boot' was built under R version 3.4.4</code></pre>
<pre><code>## 
## Attaching package: 'boot'</code></pre>
<pre><code>## The following object is masked from 'package:lattice':
## 
##     melanoma</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(aircondit)
x=hours
gaptime.hat =<span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#MLE of 1/lambda</span>
B =<span class="st"> </span><span class="dv">5000</span>  <span class="co">#no. boostrap resamples</span>
<span class="kw">set.seed</span>(<span class="dv">5</span>)
exc75.boot =<span class="st"> </span><span class="kw">boot</span>( <span class="dt">data=</span>aircondit,<span class="dt">statistic=</span><span class="cf">function</span>(x,i){<span class="kw">mean</span>(x[i,])}, <span class="dt">R=</span>B )</code></pre></div>
<p>The bootstrap summary reports:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">exc75.boot</code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = aircondit, statistic = function(x, i) {
##     mean(x[i, ])
## }, R = B)
## 
## 
## Bootstrap Statistics :
##     original     bias    std. error
## t1* 108.0833 -0.1137167    37.86823</code></pre>
<p>we can see the MLE is <span class="math inline">\(\frac{1}{\hat \lambda}\)</span>=<strong>108.0833333</strong>,with estimated std.error of<span class="math inline">\(\hat{se}_{boot}\)</span>=<strong>37.86823</strong><br />
when we calculate the confidence interval by BCa,we need the empirical influence values of the statistic of interest for the observed data.<br />
So</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">einf.jack =<span class="st"> </span><span class="kw">empinf</span>(exc75.boot, <span class="dt">type=</span><span class="st">'jack'</span>)<span class="co">#where the call to empinf() is used to generate an empirical influence object using the usual jackknife. </span>
<span class="kw">boot.ci</span>(exc75.boot, <span class="dt">type=</span><span class="kw">c</span>(<span class="st">'norm'</span>,<span class="st">'basic'</span>,<span class="st">'perc'</span>,<span class="st">'bca'</span>), <span class="dt">L=</span>einf.jack)</code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 5000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = exc75.boot, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;), L = einf.jack)
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.0, 182.4 )   ( 25.6, 171.1 )  
## 
## Level     Percentile            BCa          
## 95%   ( 45.1, 190.6 )   ( 56.7, 224.5 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>We see the intervals are quite disparate. A primary reason is that the bootstrap distribution is still skewed, affecting the simpler methods and their appeal to the Central Limit Theorem. For example</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(exc75.boot<span class="op">$</span>t, <span class="dt">main=</span><span class="st">''</span>, <span class="dt">xlab=</span><span class="kw">expression</span>(<span class="dv">1</span><span class="op">/</span>lambda), <span class="dt">prob=</span>T)
<span class="kw">points</span>(exc75.boot<span class="op">$</span>t0, <span class="dv">0</span>, <span class="dt">pch =</span> <span class="dv">19</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAeFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZrY6kLY6kNtmAABmADpmOgBmZrZmkNtmtv+QOgCQkLaQkNuQtv+Q2/+2ZgC2Zma2kDq22/+2///bkDrbkGbbtpDb////AAD/tmb/25D/27b//7b//9v///93ROXvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG6klEQVR4nO2da2ObNhSGSZN03WZva7Mt3hZWG8/x//+HQ1xsklh6pQNCR/A+n1xAF54KcSQUKM7ESZG6AtqhIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQESCSoGJCmBr5MU73gsx0cp9zVxHWSCApPPScUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEmFPQ7clVCrq1c22C/KbdVyBo9+nlfHwsirtnSXbLF9T4+VzLOW2/CbJbvKDTdlNLejA/y/t9eHZ5CzptiwdwrGk3r08b87Oq25IzO7DT8lPhQ8RBPcq6Vhvnwab1lDO1IIWCztDRafvppWlCla2XXrqgVpHl8jFUbfO3XowLF2RO33QzlusnNDvHzhwF1b100Zqx9cBB2bl3ZijotLVGf1den9pLzGpwyYJ+af24mk/Z9+CVrStfgaDSLqiLgZqj1nab310DNPttfjDAiBQo+uY0Ix9akIM1tyA/yqJrQmvsg7wwoYDBGigtVVA9Tu/P3RVH+2aHd+YmaJ7sViBozYFiMx1WOrqXsyNQjDAnrU/Q7n5/fHzoZgxvsu7bvIkCq/o27hhqrDxQrM/eTMpzqPGWwSX2cNre709bx8z0ugPFOhC6e359cs7crzZQnCc7Clq2IBgEDrF15UsWtBs1CPuQnXtnhoKa58rTZQd2eghS8pD1TRw0YXZgZ1AL0iEI3OD7g1IMVnUIasYZgERPNXQI8pgwSzXU0CHIg1SD1WwErb0F1RfZ/X7nutknGqwqEVTdPZdmNO8ylGawqkOQuX7MheOYDwrJDuzMUJDpgY2gEWtfzosW1LegnWT1VNxJex2Cuj6oxOGiX3aXLQF/oKFbUNsDe6yi8szu45bcBcXJjoJAdosR1IY48vWt77K7tSVrQbu2cy7BWnvf7G5uyVnQZen88XHqu5jspzJBg9kyx7N57+wsWzIWNBiBTT3UWIogONMTkp1lCwVRkGd2li1iQSmfAGUhyJV/bHpB1/8jCnpDZkMNCgo4Yh4oCEBBAAoCTFOiI05ZlyDB6o5VCZKs7liTINGz+TUJEq3uWJMgtiCEZHXHqgRJVndMLGj2mY98A0UKCjg4IvkGihoFqQoUFQrSdZtXKEhXoKhQEFsQwjdQLG6HK8sX5BsoSk80LN08MWOUOChY0OFwEKX7+HNyVAg6HFpD+QvyDBQDT/Rw6AyJBUW82qYJFN/VrwijExSYSkw8QR63eRGXFqSRiQNFGYr9qGhBl7uYRiYOFJfHxIGirRRNBFY97HAhrlI07Rt/uBBNEuYRFLhYWJMEtqAR+8YfLkSTBAoasW/04UEvYfIsRdO+sYfjpxqCUjTtG3m4fKihSUJEQdEGq5rRMVhVDAergHkGqxkzTxyUMRQEoCAABQEoCEBBAAoCUBCAggBxBbWRt3kbSBXwcqvjDy/haZupqo24TCtxBTUfhjaYt8tYP876DvM11+C0r0/1EaXxIirTTlxB/axIOw/g92KZqpuwDEvbvtbHPGyRlOkgrqCyq961+pCq2LSnKEjbNBhJOgdxBe2+tB1D2+x9Z9na4yRpzXv5ZWVaiSrIfOqlrvWm6wp8O4TmpCRpzTSVsEwrM9zm6/MVCBKkra7foA4u08oMgurOQHKJBacdTnMGl2llDkGfn8M6zKEg/7RvXuAXXKaVqILaOlbdR+q9b7mNoNC0/Xy5sEwrke9ipnrmJedBQVt3FwtKe3zs24+sTCuRLzHzieTuDZb+YX93iQWlLdunCeY4UZlWOFgFUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEyENQwlpSkN6i/UlZSQpSXLabdqViAwXdoFup2NBU8u/i5xT10CqoGvxpdVPH49fzv6OfIwtQKuiyUtHQ1/H0R4KaKBV0Hq4S6ut4/ClBNTIQdKmi6DvdY8lI0PHxxwR/i56RoPL++5/zVyMfQafttxS9tH5B1wa0f/19/mpkI6j5Vu5f/xx/m7ka2Qhq/vnfr+MXHQaiV1BP4hqqF5S6gqnLh6SuYOry1UNBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQH+B/0/Mn87DB+GAAAAAElFTkSuQmCC" /><!-- --> (the solid dot, ??, indicates the MLE). The BCa interval incorporates an acceleration adjustment for skew, and may be preferred here.</p>
</div>
<div id="section-7" class="section level1">
<h1>7.8</h1>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat \theta\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(bootstrap); 
<span class="kw">attach</span>(scor);<span class="co">#attach data</span>
theta =<span class="st"> </span><span class="cf">function</span>(x){
<span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values)
} <span class="co">#end function</span>
n=<span class="kw">length</span>(scor[,<span class="dv">1</span>]);
x=<span class="kw">as.matrix</span>(scor);
lambda.hat =<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values
theta.hat =<span class="st"> </span>lambda.hat[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda.hat)
theta.jack=<span class="kw">numeric</span>(n)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {theta.jack[i]=<span class="kw">theta</span>( x[<span class="op">-</span>i,] ) }<span class="co">#jackknife</span>
bias.jack=(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat)
theta.bar=<span class="kw">mean</span>(theta.jack)
se.jack =<span class="st"> </span><span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>( (theta.jack<span class="op">-</span>theta.bar)<span class="op">^</span><span class="dv">2</span> ))
<span class="kw">print</span>( <span class="kw">list</span>(<span class="dt">theta.hat=</span><span class="kw">theta</span>(scor), <span class="dt">bias=</span>bias.jack, <span class="dt">se=</span>se.jack) )</code></pre></div>
<pre><code>## $theta.hat
## [1] 0.619115
## 
## $bias
## [1] 0.001069139
## 
## $se
## [1] 0.04955231</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">detach</span>(package<span class="op">:</span>bootstrap)</code></pre></div>
<p>we see <span class="math inline">\(\hat{bias}_{jack}(\hat\theta)\)</span> =<strong>0.0010691</strong>,and <span class="math inline">\(\hat{se}_{jack}(\hat\theta)\)</span>=<strong>0.0495523</strong></p>
</div>
<div id="section-8" class="section level1">
<h1>7.11</h1>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DAAG);</code></pre></div>
<pre><code>## Warning: package 'DAAG' was built under R version 3.4.4</code></pre>
<pre><code>## 
## Attaching package: 'DAAG'</code></pre>
<pre><code>## The following object is masked from 'package:MASS':
## 
##     hills</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(ironslag);
n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span>
e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="dv">0</span>;
<span class="co"># for n/2-fold cross validation</span>
<span class="co"># fit models on leave-two-out samples</span>
<span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="op">-</span><span class="dv">1</span>)) {
a&lt;-<span class="kw">c</span>(k,(k<span class="op">+</span><span class="dv">1</span>))
y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>a]
x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>a]
J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)
ee1 =<span class="st"> </span>magnetic[a]<span class="op">-</span><span class="st"> </span><span class="kw">predict</span>( J1, <span class="dt">newdata=</span><span class="kw">data.frame</span>(<span class="dt">x=</span>chemical[a]) )
e1[k]&lt;-<span class="kw">sum</span>(ee1<span class="op">^</span><span class="dv">2</span>)
J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))
ee2 =<span class="st"> </span>magnetic[a]<span class="op">-</span><span class="st"> </span><span class="kw">predict</span>( J2, <span class="dt">newdata=</span><span class="kw">data.frame</span>(<span class="dt">x=</span>chemical[a]) )
e2[k]&lt;-<span class="kw">sum</span>(ee2<span class="op">^</span><span class="dv">2</span>)
J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)
ee3 =<span class="st"> </span>magnetic[a]<span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">predict</span>( J3, <span class="dt">newdata=</span><span class="kw">data.frame</span>(<span class="dt">x=</span>chemical[a])))
e3[k]&lt;-<span class="kw">sum</span>(ee3<span class="op">^</span><span class="dv">2</span>)
J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))
ee4 =<span class="st"> </span>magnetic[a]<span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">predict</span>( J4, <span class="dt">newdata=</span><span class="kw">data.frame</span>(<span class="dt">x=</span>chemical[a])))
e4[k]&lt;-<span class="kw">sum</span>(ee4<span class="op">^</span><span class="dv">2</span>)
}
<span class="kw">print</span>( <span class="kw">list</span>(<span class="dt">mse1=</span><span class="kw">mean</span>(e1<span class="op">/</span><span class="dv">2</span>),<span class="dt">mse2=</span><span class="kw">mean</span>(e2<span class="op">/</span><span class="dv">2</span>),<span class="dt">mse3=</span><span class="kw">mean</span>(e3<span class="op">/</span><span class="dv">2</span>),<span class="dt">mse4=</span><span class="kw">mean</span>(e4<span class="op">/</span><span class="dv">2</span>)) )</code></pre></div>
<pre><code>## $mse1
## [1] 20.05231
## 
## $mse2
## [1] 17.96998
## 
## $mse3
## [1] 18.58856
## 
## $mse4
## [1] 20.74569</code></pre>
<p>We can see Model 2 has the least prediction error <strong>17.96998</strong>.<br />
So according to the prediction error criterion, Model 2, the quadratic model,would be the best fit for the data.  title: Homwork-2018-11-09 author: A18003 date: 2018/11/09 output: html_document </p>
</div>
<div id="section-9" class="section level1">
<h1>8.1</h1>
<p>Implement the two-sample Cram??er-von Mises test for equal distributions as a permutation test. Apply the test to the data in Examples 8.1 and 8.2 Cram??er-von Mises where the Cram??er-von Mises distance is defined by <span class="math display">\[W_2=\frac{mn}{(m+n)^2}[\sum^n_{i=1}(F_n(x_i)-G_m(x_i))^2+\sum^m_{j=1}(F_n(y_j)-G_m(y_j))^2]\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cvm&lt;-<span class="cf">function</span>(x,y,N){
  reps&lt;-<span class="kw">numeric</span>(N);<span class="co">#permutation numbers</span>
  n&lt;-<span class="kw">length</span>(x);
  m&lt;-<span class="kw">length</span>(y);
  f&lt;-<span class="kw">ecdf</span>(x);
  g&lt;-<span class="kw">ecdf</span>(y);
  z&lt;-<span class="kw">c</span>(x,y);
  t&lt;-<span class="kw">numeric</span>(N);
  t0&lt;-m<span class="op">*</span>n<span class="op">/</span>(m<span class="op">+</span>n)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">sum</span>((<span class="kw">f</span>(x)<span class="op">-</span><span class="kw">g</span>(x))<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">sum</span>((<span class="kw">f</span>(y)<span class="op">-</span><span class="kw">g</span>(y))<span class="op">^</span><span class="dv">2</span>));
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){
    k&lt;-<span class="kw">sample</span>(<span class="kw">length</span>(z),<span class="dt">size=</span>n,<span class="dt">replace =</span> <span class="ot">FALSE</span>);
    x1&lt;-z[k];
    y1&lt;-z[<span class="op">-</span>k];
    f1&lt;-<span class="kw">ecdf</span>(x1);
    g1&lt;-<span class="kw">ecdf</span>(y1);
    t[i]&lt;-m<span class="op">*</span>n<span class="op">/</span>(m<span class="op">+</span>n)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">sum</span>((<span class="kw">f1</span>(x)<span class="op">-</span><span class="kw">g1</span>(x))<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">sum</span>((<span class="kw">f1</span>(y)<span class="op">-</span><span class="kw">g1</span>(y))<span class="op">^</span><span class="dv">2</span>))
  } 
  <span class="kw">return</span>(<span class="kw">c</span>(t0,t));
}
<span class="co">#example 1</span>
<span class="kw">set.seed</span>(<span class="dv">2</span>)
<span class="kw">attach</span>(chickwts)
x1 &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;soybean&quot;</span>]));
y1 &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;linseed&quot;</span>]));
cvm1&lt;-<span class="kw">cvm</span>(x1,y1,<span class="dv">999</span>);
p1 &lt;-<span class="st"> </span><span class="kw">mean</span>(cvm1 <span class="op">&gt;=</span><span class="st"> </span>cvm1[<span class="dv">1</span>]);
p1</code></pre></div>
<pre><code>## [1] 0.385</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(cvm1, <span class="dt">main =</span> <span class="st">&quot;Cram??er-von Mises test&quot;</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;w (p = 0.385)&quot;</span>,<span class="dt">breaks =</span> <span class="st">&quot;scott&quot;</span>);
<span class="kw">points</span>(cvm1[<span class="dv">1</span>], <span class="dv">0</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">pch =</span> <span class="dv">16</span>);</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">detach</span>(chickwts)</code></pre></div>
<p>from the table we can accept x and y have the same distribution.</p>
</div>
<div id="experiment" class="section level1">
<h1>experiment</h1>
<p>Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations.<br />
&gt; Unequal variances and equal expectations<br />
&gt; Unequal variances and unequal expectations<br />
&gt; Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)<br />
&gt; Unbalanced samples (say, 1 case versus 10 controls)<br />
&gt; Note: The parameters should be choosen such that the powers are distinguishable (say, range from 0.3 to 0.9).<br />
##example 1</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RANN)</code></pre></div>
<pre><code>## Warning: package 'RANN' was built under R version 3.4.4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(energy)</code></pre></div>
<pre><code>## Warning: package 'energy' was built under R version 3.4.4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Ball)</code></pre></div>
<pre><code>## Warning: package 'Ball' was built under R version 3.4.4</code></pre>
<pre><code>## Loading required package: gam</code></pre>
<pre><code>## Warning: package 'gam' was built under R version 3.4.4</code></pre>
<pre><code>## Loading required package: splines</code></pre>
<pre><code>## Loading required package: foreach</code></pre>
<pre><code>## Warning: package 'foreach' was built under R version 3.4.4</code></pre>
<pre><code>## Loaded gam 1.16</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## 
## Attaching package: 'survival'</code></pre>
<pre><code>## The following object is masked from 'package:DAAG':
## 
##     lung</code></pre>
<pre><code>## The following object is masked from 'package:boot':
## 
##     aml</code></pre>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Warning: package 'mvtnorm' was built under R version 3.4.4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot)
<span class="kw">library</span>(ggplot2)
<span class="kw">set.seed</span>(<span class="dv">123</span>)
m &lt;-<span class="st"> </span><span class="dv">50</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>;
n1&lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)

Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {
n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2
<span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);
z &lt;-<span class="st"> </span>z[ix, ];
NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what's the first column?</span>
block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]
block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]
i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>)
(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)
}

eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){
  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)
  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)
  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])
  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)
}

p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dt">mean =</span> <span class="dv">1</span>,<span class="dt">sd =</span> <span class="fl">0.6</span>),<span class="dt">ncol=</span>p);
  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">mean =</span> <span class="dv">1</span>,<span class="dt">sd =</span> <span class="fl">0.8</span>),<span class="dt">ncol=</span>p);
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed =</span> i<span class="op">*</span><span class="dv">12</span>)<span class="op">$</span>p.value
}
alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
<span class="kw">print</span>(pow)</code></pre></div>
<pre><code>## [1] 0.16 0.12 0.60</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">power &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">'NN'</span>,<span class="st">'energy'</span>,<span class="st">'Ball'</span>),pow)
<span class="kw">ggplot</span>(power,<span class="kw">aes</span>(methods,pow))<span class="op">+</span><span class="co">#plot</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">'palegreen3'</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> #example 2</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">122</span>)
m &lt;-<span class="st"> </span><span class="dv">50</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>;
n1&lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)

Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {
n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2
<span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);
z &lt;-<span class="st"> </span>z[ix, ];
NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what's the first column?</span>
block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]
block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]
i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>)
(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)
}

eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){
  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)
  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)
  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])
  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)
}

p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,<span class="dt">mean =</span> <span class="fl">0.3</span>,<span class="dt">sd =</span> <span class="fl">0.6</span>),<span class="dt">ncol=</span>p);
  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">mean =</span> <span class="fl">0.4</span>,<span class="dt">sd =</span> <span class="fl">0.8</span>),<span class="dt">ncol=</span>p);
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed =</span> i<span class="op">*</span><span class="dv">12</span>)<span class="op">$</span>p.value
}
alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
<span class="kw">print</span>(pow)</code></pre></div>
<pre><code>## [1] 0.16 0.30 0.66</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">power &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">'NN'</span>,<span class="st">'energy'</span>,<span class="st">'Ball'</span>),pow)
<span class="kw">ggplot</span>(power,<span class="kw">aes</span>(methods,pow))<span class="op">+</span><span class="co">#plot</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">'palegreen3'</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> #example 3</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">124</span>)
m &lt;-<span class="st"> </span><span class="dv">50</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; 
n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)

Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {
n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2
<span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);
z &lt;-<span class="st"> </span>z[ix, ];
NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what's the first column?</span>
block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]
block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]
i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>)
(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)
}

eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){
  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)
  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)
  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])
  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)
}

p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  <span class="co"># t distribution with 1 df (heavy-tailed distribution)</span>
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dt">df =</span> <span class="dv">1</span>),<span class="dt">ncol=</span>p); 
  <span class="co">#bimodel distribution (mixture of two normal distributions)</span>
  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dt">mean =</span> <span class="fl">0.4</span>),<span class="kw">rnorm</span>(n2,<span class="dt">mean =</span> <span class="fl">0.5</span>));
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed =</span> i<span class="op">*</span><span class="dv">12</span>)<span class="op">$</span>p.value
}
alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
<span class="kw">print</span>(pow)</code></pre></div>
<pre><code>## [1] 0.42 0.88 0.92</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">power &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">'NN'</span>,<span class="st">'energy'</span>,<span class="st">'Ball'</span>),pow)
<span class="kw">ggplot</span>(power,<span class="kw">aes</span>(methods,pow))<span class="op">+</span><span class="co">#plot</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">'palegreen3'</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> #example 4</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">125</span>)
m &lt;-<span class="st"> </span><span class="dv">50</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; 
n1 &lt;-<span class="st"> </span><span class="dv">10</span>;n2 &lt;-<span class="st"> </span><span class="dv">100</span>;R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)

Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {
n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2
<span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);
z &lt;-<span class="st"> </span>z[ix, ];
NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what's the first column?</span>
block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]
block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]
i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>)
(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)
}

eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){
  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)
  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)
  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])
  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)
}

p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rnorm</span>(n1,<span class="dt">mean =</span> <span class="dv">1</span>,<span class="dt">sd =</span> <span class="dv">1</span>)); <span class="co"># n1 = 10</span>
  y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rnorm</span>(n2,<span class="dt">mean =</span> <span class="dv">2</span>,<span class="dt">sd =</span> <span class="dv">2</span>)); <span class="co"># n2 = 100</span>
  z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)
  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value
  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value
  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed =</span> i<span class="op">*</span><span class="dv">12</span>)<span class="op">$</span>p.value
}
alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
<span class="kw">print</span>(pow)</code></pre></div>
<pre><code>## [1] 0.08 0.58 0.68</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">power &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">'NN'</span>,<span class="st">'energy'</span>,<span class="st">'Ball'</span>),pow)
<span class="kw">ggplot</span>(power,<span class="kw">aes</span>(methods,pow))<span class="op">+</span><span class="co">#plot</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">'palegreen3'</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> #9.3 Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a Cauchy(??, ??) distribution has density function <span class="math display">\[f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)}\]</span> The standard Cauchy has the Cauchy(?? = 1, ?? = 0) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f903 &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">eta=</span><span class="dv">0</span>, <span class="dt">theta=</span><span class="dv">1</span>) {
<span class="kw">stopifnot</span>( theta <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> )
<span class="kw">return</span>( <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(pi<span class="op">*</span>theta <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>((x<span class="op">-</span>eta)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>)) )
} <span class="co">#end function</span>
<span class="kw">set.seed</span>(<span class="dv">903</span>)
m &lt;-<span class="st"> </span><span class="dv">10000</span>
sigma =<span class="st"> </span><span class="dv">1</span> <span class="co">#try sigma = 1 for proposal scale</span>
x &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
x[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,sigma) <span class="co">#initialize with X0~N(0,sigma^2)</span>
k &lt;-<span class="st"> </span><span class="dv">0</span>
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {
xt &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> xt, <span class="dt">sd =</span> sigma)
num &lt;-<span class="st"> </span><span class="kw">f903</span>(y) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(xt, <span class="dt">mean =</span> y, <span class="dt">sd =</span> sigma)
den &lt;-<span class="st"> </span><span class="kw">f903</span>(xt) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(y, <span class="dt">mean =</span> xt, <span class="dt">sd =</span> sigma)
<span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>num<span class="op">/</span>den) x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {
x[i] &lt;-<span class="st"> </span>xt
k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span> <span class="co">#y is rejected</span>
} <span class="co">#end if/else</span>
} <span class="co">#end for loop</span>
<span class="kw">print</span>(k<span class="op">/</span>m) <span class="co">#rejection rate</span></code></pre></div>
<pre><code>## [1] 0.239</code></pre>
<p>(One could just use dcauchy(x) instead of the constructed function f903(x) for the Cauchy p.d.f.) The rejection rate is given as0.239 which is rather low (i.e., higher-than-desired acceptance). Setting the burn-in to bo = 1000 draws, the retained chain is found via</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">b0 =<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in</span>
index =<span class="st"> </span>(b0<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>m
y1 =<span class="st"> </span>x[index] <span class="co">#chain after burn-in</span></code></pre></div>
<p>To compare deciles with the theoretical Cauchy(0,1) p.d.f., sample R code is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p10 =<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">1</span>,.<span class="dv">9</span>, .<span class="dv">1</span>)
<span class="kw">round</span>( <span class="kw">rbind</span>( <span class="kw">quantile</span>(y1, p10), <span class="kw">qcauchy</span>(p10) ), <span class="dv">3</span> )</code></pre></div>
<pre><code>##         10%    20%    30%    40%    50%   60%   70%   80%   90%
## [1,] -2.951 -1.361 -0.704 -0.304 -0.009 0.303 0.675 1.247 2.753
## [2,] -3.078 -1.376 -0.727 -0.325  0.000 0.325 0.727 1.376 3.078</code></pre>
<p>which produces not-unreasonable comparisons, but with some discrepancies in the tails: The trace plot, from</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>( y1<span class="op">~</span>index, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span> )</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> Interestingly, a histogram of the retained chain (using b0 = 1000), with the target Cauchy(0,1) p.d.f., from the R code</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>( y1, <span class="dt">prob=</span>T, <span class="dt">main=</span><span class="st">''</span>, <span class="dt">xlab=</span><span class="st">'x'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">35</span>), <span class="dt">breaks=</span><span class="dv">50</span> )
xarg =<span class="st"> </span><span class="kw">seq</span>( <span class="kw">min</span>(y1), <span class="kw">max</span>(y1), <span class="fl">0.1</span> )
<span class="kw">lines</span>( xarg, <span class="kw">f903</span>(xarg), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">35</span>) )</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> Moving to, say, m = 50,000 draws leads to slight, but not satiating improvement (try it!). Living up to its reputation, the Cauchy is a difficult distribution with which to operate. #9.6 Rao [220, Sec. 5g] presented an example on genetic linkage of 197 animals in four categories (also discussed in [67, 106, 171, 266]). The group sizes are278 Statistical Computing with R (125, 18, 20, 34). Assume that the probabilities of the corresponding multinomial distribution are <span class="math display">\[(\frac{1}{2}+\frac{\theta}{4},\frac{1-\theta}{4},\frac{1-\theta}{4},\frac{\theta}{4})\]</span> Estimate the posterior distribution of ?? given the observed sample, using one of the methods in this chapter. #solution Set the prior on <span class="math inline">\(\theta\)</span>??? to ??? ~ U(0,1) so that <span class="math inline">\(\pi(\theta???) = I_{(0,1)}(\theta)\)</span>. The multinomial likelihood is<span class="math inline">\(f(X|\theta???)\propto \prod _ip_i(\theta)^{x_i}/x_i!\)</span>, where <span class="math inline">\(p_1(\theta)=(2+\theta)/4,p_2(\theta???)=p_3(\theta)=(1-\theta)/4, and\,\,\, p_4(\theta???) =\theta ???/4\)</span>. Combining these via Bayes?? Rule produces the posterior <span class="math display">\[f (\theta|X)=\pi(\theta)f(X|\theta)/f(X)\propto(2+\theta)^{x_1}(1-\theta)^{x_2+x_3}\theta^{x_4}\]</span> Notice that posterior specification to proportionality is all that is needed here, since any constants in<span class="math inline">\(f(\theta???|X)\)</span> will cancel in the construction of <span class="math inline">\(r(\theta_t,Y)\)</span> in the McMC sampler.<br />
For the proposal density, we usually desire a p.d.f. <span class="math inline">\(g(y|\theta)\)</span> defined over a space the same as that for ???; here this is 0 &lt; y &lt; 1. The simple choice of$ g(y|)=I_{(0,1)}(y)$, i.e., a uniform proposal independent of ???, corresponds to an independence sampler. However,independence samplers are not typically recommended. Instead, try a beta p.d.f.proposal with expected value equal to ???t. Different possibilities exist; one is <span class="math inline">\(Y|\theta \sim\beta(\theta_t/{1-\theta_t},1)\)</span>, where<span class="math inline">\(E[Y|\theta_t]=[\theta_???t/{1?C\theta_t}]/[1+(\theta_???t/{1?C\theta_???t})] =\theta_t (For 0 &lt; \theta &lt;1)\)</span>, this is a right-skewed, decreasing p.d.f.) Sample R code for an McMC sampler from$ f(???|X)$</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f906 &lt;-<span class="st"> </span><span class="cf">function</span>( th,x ) {
<span class="cf">if</span> (th<span class="op">&lt;</span><span class="dv">0</span> <span class="op">||</span><span class="st"> </span>th<span class="op">&gt;</span><span class="dv">1</span> ) <span class="kw">return</span> (<span class="dv">0</span>)
(<span class="dv">2</span><span class="op">+</span>th)<span class="op">^</span>x[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>th)<span class="op">^</span>(x[<span class="dv">2</span>]<span class="op">+</span>x[<span class="dv">3</span>]) <span class="op">*</span><span class="st"> </span>th<span class="op">^</span>x[<span class="dv">4</span>]
} <span class="co">#end function</span>
xdata =<span class="st"> </span><span class="kw">c</span>( <span class="dv">125</span>, <span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">34</span> ) <span class="co">#observed multinom. data</span>
m =<span class="st"> </span><span class="dv">10000</span>
<span class="kw">set.seed</span>(<span class="dv">906</span>)
th =<span class="st"> </span><span class="kw">numeric</span>(m)
th[<span class="dv">1</span>] =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) <span class="co">#initialize: sample from prior on theta</span>
k =<span class="st"> </span><span class="dv">0</span>
u =<span class="st"> </span><span class="kw">runif</span>(m)
##employ skewed beta proposal density
<span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {
xt =<span class="st"> </span>th[t<span class="op">-</span><span class="dv">1</span>]
alph =<span class="st"> </span>xt<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>xt)
y &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>, <span class="dt">shape1=</span>alph, <span class="dt">shape2=</span><span class="dv">1</span> )
numer =<span class="st"> </span><span class="kw">f906</span>( y,xdata ) <span class="op">*</span><span class="st"> </span><span class="kw">dbeta</span>( xt, y<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>y), <span class="dv">1</span>)
denom =<span class="st"> </span><span class="kw">f906</span>( xt,xdata ) <span class="op">*</span><span class="st"> </span><span class="kw">dbeta</span>( y, alph, <span class="dv">1</span>)
<span class="cf">if</span> ( u[t] <span class="op">&lt;=</span><span class="st"> </span>numer<span class="op">/</span>denom )
th[t] =<span class="st"> </span>y <span class="cf">else</span> {
th[t] =<span class="st"> </span>th[t<span class="op">-</span><span class="dv">1</span>]
k =<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
} <span class="co">#end if/else</span>
} <span class="co">#end for loop</span></code></pre></div>
<p>Using this code, the posterior sample of 10,000 points resides in the vector th; its raw trace plot is found via</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>( th, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(th),
<span class="dt">xlab=</span><span class="kw">bquote</span>(theta), <span class="dt">ylab=</span><span class="st">&quot;posterior&quot;</span> )</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> This produces<br />
which appears somewhat variable, but not otherwise unacceptable. A burn-in of perhaps bo = 2000 will likely suffice. The consequent histogram, found via</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>( th[<span class="dv">2001</span><span class="op">:</span>m], <span class="dt">prob=</span>T, <span class="dt">breaks=</span><span class="st">&quot;Scott&quot;</span>,
<span class="dt">xlab=</span><span class="kw">bquote</span>(theta), <span class="dt">ylab=</span><span class="st">'posterior'</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span> )</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> shows a generally unimodal, slightly left-skewed sample.<br />
The associated posterior mean (a Bayesian estimate) of ???, and the corresponding posterior ??cell?? probabilities are found via</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">theta.hat =<span class="st"> </span><span class="kw">mean</span>( th[<span class="dv">2001</span><span class="op">:</span>m] )
theta.hat</code></pre></div>
<pre><code>## [1] 0.623192</code></pre>
<p>and</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">c</span>( <span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span>theta.hat<span class="op">/</span><span class="dv">4</span>, (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta.hat)<span class="op">/</span><span class="dv">4</span>,
(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta.hat)<span class="op">/</span><span class="dv">4</span>, theta.hat<span class="op">/</span><span class="dv">4</span>) ) <span class="co">#p.hat vector</span></code></pre></div>
<pre><code>## [1] 0.655798 0.094202 0.094202 0.155798</code></pre>
<p>respectively.</p>
</div>
<div id="section-10" class="section level1">
<h1>11.4</h1>
<p>Find the intersection points A(k) in <span class="math inline">\((0, \sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}})\]</span> and<span class="math display">\[S_{k}(a)=P(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}})\]</span> for k = 4 : 25, 100, 500, 1000, where t(k) is a Student t random variable with k degrees of freedom.</p>
<div id="solution" class="section level2">
<h2>solution:</h2>
<p>The upper-tail t-probabilities are found via the pt() function with the lower.tail=F option. The intersection of the two upper-tail functions <span class="math inline">\(S_{k-1}(a)\)</span>and<span class="math inline">\(S_k(a)\)</span> occurs when their difference is zero. A quick plot of selected differences <span class="math inline">\(S_{k-1}(a)-S_k(a)\)</span> shows that the likely solutions occur in the interval<span class="math inline">\(1&lt;a&lt;2\)</span>, so use this as the capture interval for application of Brent??s method</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">k =<span class="st"> </span><span class="kw">c</span>( <span class="dv">4</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span> )
object =<span class="st"> </span><span class="cf">function</span>( a, df ){
 a2 =<span class="st"> </span>a<span class="op">^</span><span class="dv">2</span>
 arg =<span class="st"> </span><span class="kw">sqrt</span>( a2<span class="op">*</span>df<span class="op">/</span>(df <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>a2) )
 Sk =<span class="st"> </span><span class="kw">pt</span>( <span class="dt">q=</span>arg, <span class="dt">df=</span>df, <span class="dt">lower=</span>F)
 arg =<span class="st"> </span><span class="kw">sqrt</span>( a2<span class="op">*</span>(df<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(df <span class="op">-</span><span class="st"> </span>a2) )
 Skm1 =<span class="st"> </span><span class="kw">pt</span>( <span class="dt">q=</span>arg, <span class="dt">df=</span>df<span class="op">-</span><span class="dv">1</span>, <span class="dt">lower=</span>F)
 <span class="kw">return</span>( Sk<span class="op">-</span>Skm1 )
 } <span class="co">#end function</span>
<span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k) ) {
 <span class="kw">print</span>( <span class="kw">c</span>( k[i], <span class="kw">uniroot</span>(object, <span class="dt">lower=</span><span class="dv">1</span>, <span class="dt">upper=</span><span class="dv">2</span>, <span class="dt">df=</span>k[i])<span class="op">$</span>root ) )
 } <span class="co">#end for loop </span></code></pre></div>
<pre><code>## [1] 4.000000 1.492103
## [1] 5.000000 1.533556
## [1] 6.000000 1.562744
## [1] 7.00000 1.58443
## [1] 8.000000 1.601185
## [1] 9.000000 1.614521
## [1] 10.00000  1.62539
## [1] 11.000000  1.634419
## [1] 12.000000  1.642038
## [1] 13.000000  1.648554
## [1] 14.00000  1.65419
## [1] 15.000000  1.659114
## [1] 16.000000  1.663452
## [1] 17.000000  1.667303
## [1] 18.000000  1.670745
## [1] 19.00000  1.67384
## [1] 20.000000  1.676637
## [1] 21.000000  1.679178
## [1] 22.000000  1.681496
## [1] 23.00000  1.68362
## [1] 24.000000  1.685572
## [1] 25.000000  1.687373
## [1] 100.000000   1.720608
## [1] 500.000000   1.729755
## [1] 1000.000000    1.730907</code></pre>
</div>
</div>
<div id="p204-ex3" class="section level1">
<h1>p204 Ex3</h1>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:<br />
formulas &lt;- list(<br />
mpg ~ disp,<br />
mpg ~ I(1 / disp),<br />
mpg ~ disp + wt,<br />
mpg ~ I(1 / disp) + wt<br />
)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attach</span>(mtcars)</code></pre></div>
<pre><code>## The following object is masked from package:ggplot2:
## 
##     mpg</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(
  mpg <span class="op">~</span><span class="st"> </span>disp,
  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),
  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,
  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt
)
<span class="co">#1 for loops</span>
lf_<span class="dv">3</span>&lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)){
  lf_<span class="dv">3</span>[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], <span class="dt">data =</span> mtcars)
}
<span class="co">#2 lapply</span>
la_<span class="dv">3</span>&lt;-<span class="kw">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="kw">lm</span>(<span class="dt">formula =</span> x, <span class="dt">data =</span> mtcars))</code></pre></div>
</div>
<div id="p204-ex4" class="section level1">
<h1>p204 Ex4</h1>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply().Can you do it without an anonymous function?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {
  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)
  mtcars[rows, ]
})
<span class="co"># for loops</span>
lf_<span class="dv">4</span>&lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(bootstraps))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)){
  lf_<span class="dv">4</span>[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp, <span class="dt">data =</span> bootstraps[[i]])
}
<span class="co"># lapply without anonymous function</span>
la_<span class="dv">4</span>&lt;-<span class="st"> </span><span class="kw">lapply</span>(bootstraps, lm, <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp)</code></pre></div>
</div>
<div id="p204-ex5" class="section level1">
<h1>p204 Ex5</h1>
<p>For each model in the previous two exercises, extract R2 using the function below. rsq &lt;- function(mod) summary(mod)$r.squared</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared
<span class="co">#For the models in exercise 3:</span>
<span class="kw">sapply</span>(la_<span class="dv">3</span>, rsq)</code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(lf_<span class="dv">3</span>, rsq)</code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#For the models in exercise 4:</span>
<span class="kw">sapply</span>(la_<span class="dv">4</span>,rsq)</code></pre></div>
<pre><code>##  [1] 0.7475099 0.7179526 0.7571433 0.6921848 0.8488426 0.7702828 0.7491175
##  [8] 0.7843995 0.6779810 0.7887093</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(lf_<span class="dv">4</span>,rsq)</code></pre></div>
<pre><code>##  [1] 0.7475099 0.7179526 0.7571433 0.6921848 0.8488426 0.7702828 0.7491175
##  [8] 0.7843995 0.6779810 0.7887093</code></pre>
</div>
<div id="p213-ex3" class="section level1">
<h1>P213 Ex3</h1>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">3</span>)
trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(
<span class="dv">100</span>,
<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),
<span class="dt">simplify =</span> <span class="ot">FALSE</span>
)
<span class="co"># anonymous function:</span>
<span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x[[<span class="st">&quot;p.value&quot;</span>]])</code></pre></div>
<pre><code>##   [1] 0.592989530 0.860635317 0.457194299 0.464414050 0.861136801
##   [6] 0.063190547 0.569502932 0.756227376 0.559964309 0.181342651
##  [11] 0.054475511 0.404039022 0.028263746 0.586973905 0.417952637
##  [16] 0.622517735 0.962475011 0.961899636 0.248745081 0.292032336
##  [21] 0.182470055 0.235947796 0.234205401 0.290850170 0.681674611
##  [26] 0.089162807 0.645738662 0.607504699 0.531434113 0.892755819
##  [31] 0.142892712 0.369149088 0.884758267 0.630990146 0.125399860
##  [36] 0.626195191 0.084367122 0.204800311 0.893392460 0.424410366
##  [41] 0.663305449 0.470146902 0.667863051 0.945399751 0.443769951
##  [46] 0.008379362 0.355268873 0.323780588 0.788073909 0.354000303
##  [51] 0.712108509 0.097720743 0.062697203 0.767643566 0.416754708
##  [56] 0.070905658 0.280146392 0.486179373 0.017698942 0.309200706
##  [61] 0.524291534 0.157700776 0.913101019 0.374055340 0.552822199
##  [66] 0.640038892 0.625274377 0.217529254 0.397668201 0.339979768
##  [71] 0.469358999 0.663589606 0.132012648 0.802848226 0.911116233
##  [76] 0.287421841 0.225513423 0.190561294 0.379953570 0.992000657
##  [81] 0.883548073 0.724932819 0.152834596 0.720466481 0.719262968
##  [86] 0.233073377 0.942871565 0.406357343 0.035625568 0.828393863
##  [91] 0.229905702 0.929111103 0.455995640 0.741496874 0.287480071
##  [96] 0.935551251 0.968033046 0.706707747 0.621409732 0.962878707</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># without anonymous function:</span>
<span class="kw">sapply</span>(trials, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;p.value&quot;</span>)</code></pre></div>
<pre><code>##   [1] 0.592989530 0.860635317 0.457194299 0.464414050 0.861136801
##   [6] 0.063190547 0.569502932 0.756227376 0.559964309 0.181342651
##  [11] 0.054475511 0.404039022 0.028263746 0.586973905 0.417952637
##  [16] 0.622517735 0.962475011 0.961899636 0.248745081 0.292032336
##  [21] 0.182470055 0.235947796 0.234205401 0.290850170 0.681674611
##  [26] 0.089162807 0.645738662 0.607504699 0.531434113 0.892755819
##  [31] 0.142892712 0.369149088 0.884758267 0.630990146 0.125399860
##  [36] 0.626195191 0.084367122 0.204800311 0.893392460 0.424410366
##  [41] 0.663305449 0.470146902 0.667863051 0.945399751 0.443769951
##  [46] 0.008379362 0.355268873 0.323780588 0.788073909 0.354000303
##  [51] 0.712108509 0.097720743 0.062697203 0.767643566 0.416754708
##  [56] 0.070905658 0.280146392 0.486179373 0.017698942 0.309200706
##  [61] 0.524291534 0.157700776 0.913101019 0.374055340 0.552822199
##  [66] 0.640038892 0.625274377 0.217529254 0.397668201 0.339979768
##  [71] 0.469358999 0.663589606 0.132012648 0.802848226 0.911116233
##  [76] 0.287421841 0.225513423 0.190561294 0.379953570 0.992000657
##  [81] 0.883548073 0.724932819 0.152834596 0.720466481 0.719262968
##  [86] 0.233073377 0.942871565 0.406357343 0.035625568 0.828393863
##  [91] 0.229905702 0.929111103 0.455995640 0.741496874 0.287480071
##  [96] 0.935551251 0.968033046 0.706707747 0.621409732 0.962878707</code></pre>
</div>
<div id="ex-4" class="section level1">
<h1>Ex 4</h1>
<p>Make a faster version of chisq.test() that only computes the chi-square test statistic when the input is two numeric vectors with no missing values. You can try simplifying chisq.test() or by coding from the mathematical definition</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">warn =</span> <span class="op">-</span><span class="dv">1</span>)
chisq.test1&lt;-<span class="st"> </span><span class="cf">function</span>(x, y){
  <span class="co">#????????????</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.numeric</span>(x)) {
    <span class="kw">stop</span>(<span class="st">&quot;x must be numeric&quot;</span>)}
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.numeric</span>(y)) {
    <span class="kw">stop</span>(<span class="st">&quot;y must be numeric&quot;</span>)}
  <span class="cf">if</span> (<span class="kw">length</span>(x) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(y)) {
    <span class="kw">stop</span>(<span class="st">&quot;x and y must have the same length&quot;</span>)}
  <span class="cf">if</span> (<span class="kw">length</span>(x) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>) {
    <span class="kw">stop</span>(<span class="st">&quot;length of x must be greater one&quot;</span>)}
  <span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">c</span>(x, y) <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)) {
    <span class="kw">stop</span>(<span class="st">&quot;all entries of x and y must be greater or equal zero&quot;</span>)}
  <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">complete.cases</span>(x, y)) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(x)) {
    <span class="kw">stop</span>(<span class="st">&quot;there must be no missing values in x and y&quot;</span>)}
  <span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">is.null</span>(<span class="kw">c</span>(x, y)))) {
    <span class="kw">stop</span>(<span class="st">&quot;entries of x and y must not be NULL&quot;</span>)}
  <span class="co">#????</span>
  m &lt;-<span class="st"> </span><span class="kw">rbind</span>(x, y)
  margin1 &lt;-<span class="st"> </span><span class="kw">rowSums</span>(m)
  margin2 &lt;-<span class="st"> </span><span class="kw">colSums</span>(m)
  n &lt;-<span class="st"> </span><span class="kw">sum</span>(m)
  me &lt;-<span class="st"> </span><span class="kw">tcrossprod</span>(margin1, margin2) <span class="op">/</span><span class="st"> </span>n
  x_stat =<span class="st"> </span><span class="kw">sum</span>((m <span class="op">-</span><span class="st"> </span>me)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>me)<span class="co">#chisq??</span>
  dof &lt;-<span class="st"> </span>(<span class="kw">length</span>(margin1) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">length</span>(margin2) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="co">#???? </span>
  p &lt;-<span class="st"> </span><span class="kw">pchisq</span>(x_stat, <span class="dt">df =</span> dof, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)<span class="co">#p</span>
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x_stat =</span> x_stat, <span class="dt">df =</span> dof, <span class="st">`</span><span class="dt">p-value</span><span class="st">`</span> =<span class="st"> </span>p))
}
<span class="co">#check</span>
a=<span class="dv">31</span><span class="op">:</span><span class="dv">35</span>;
b=<span class="kw">c</span>(<span class="dv">31</span>,<span class="dv">33</span>,<span class="dv">35</span>,<span class="dv">37</span>,<span class="dv">39</span>);
m&lt;-<span class="kw">cbind</span>(a,b)
<span class="kw">chisq.test1</span>(a,b)</code></pre></div>
<pre><code>## $x_stat
## [1] 0.1231738
## 
## $df
## [1] 4
## 
## $`p-value`
## [1] 0.9981796</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(m)</code></pre></div>
<pre><code>## 
##  Pearson's Chi-squared test
## 
## data:  m
## X-squared = 0.12317, df = 4, p-value = 0.9982</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(
  <span class="kw">chisq.test</span>(m),
  <span class="kw">chisq.test1</span>(a, b))</code></pre></div>
<pre><code>## Unit: microseconds
##               expr    min      lq     mean  median     uq     max neval
##      chisq.test(m) 74.215 75.7945 84.60105 77.7675 79.742 211.590   100
##  chisq.test1(a, b) 19.738 21.3180 25.88101 24.4755 26.647  69.084   100</code></pre>
</div>
<div id="ex-5" class="section level1">
<h1>Ex 5</h1>
<p>Can you make a faster version of table() for the case of an input of two integer vectors with no missing values? Can you use it to speed up your chi-square test?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table2 &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {
  x_val &lt;-<span class="st"> </span><span class="kw">unique</span>(x)
  y_val &lt;-<span class="st"> </span><span class="kw">unique</span>(y)
  mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(0L, <span class="kw">length</span>(x_val), <span class="kw">length</span>(y_val))
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x)) {
    mat[<span class="kw">which</span>(x_val <span class="op">==</span><span class="st"> </span>x[[i]]), <span class="kw">which</span>(y_val <span class="op">==</span><span class="st"> </span>y[[i]])] &lt;-
<span class="st">      </span>mat[<span class="kw">which</span>(x_val <span class="op">==</span><span class="st"> </span>x[[i]]),  <span class="kw">which</span>(y_val <span class="op">==</span><span class="st"> </span>y[[i]])] <span class="op">+</span><span class="st"> </span>1L
  }
  dimnames &lt;-<span class="st"> </span><span class="kw">list</span>(x_val, y_val)
  <span class="kw">names</span>(dimnames) &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">as.list</span>(<span class="kw">match.call</span>())[<span class="op">-</span><span class="dv">1</span>])  <span class="co"># R has names for dimnames... :/</span>
  tab &lt;-<span class="st"> </span><span class="kw">array</span>(mat, <span class="dt">dim =</span> <span class="kw">dim</span>(mat), <span class="dt">dimnames =</span> dimnames)
  <span class="kw">class</span>(tab) &lt;-<span class="st"> &quot;table&quot;</span>
  tab
}
a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)
b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)
<span class="kw">identical</span>(<span class="kw">table</span>(a, b), <span class="kw">table2</span>(a, b))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(<span class="kw">table</span>(a, b), <span class="kw">table2</span>(a, b))</code></pre></div>
<pre><code>## Unit: microseconds
##          expr     min      lq     mean  median      uq     max neval
##   table(a, b) 188.694 192.247 203.6754 197.379 202.313 408.179   100
##  table2(a, b)  61.977  65.728  72.9359  70.267  73.228 289.357   100</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">c&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)
<span class="kw">identical</span>(<span class="kw">table</span>(c, c), <span class="kw">table2</span>(c, c))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(<span class="kw">table</span>(c, c), <span class="kw">table2</span>(c, c))</code></pre></div>
<pre><code>## Unit: microseconds
##          expr     min       lq      mean  median       uq     max neval
##   table(c, c) 188.695 194.6155 204.95445 200.143 203.6950 455.945   100
##  table2(c, c)  62.372  65.5300  69.59244  69.676  73.0305  94.348   100</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
